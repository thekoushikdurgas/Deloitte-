2025-09-03 08:11:32,076 - root - DEBUG - [common.py:105] - Starting main conversion workflow
2025-09-03 08:11:32,076 - root - INFO - [common.py:110] - === Starting Oracle Trigger Conversion Process ===
2025-09-03 08:11:32,076 - root - INFO - [common.py:110] - Logging to: output\oracle_conversion_20250903_081132.log
2025-09-03 08:11:32,076 - root - DEBUG - [common.py:105] - Logging system initialized
2025-09-03 08:11:32,081 - root - INFO - [common.py:110] - Step 1: Converting Oracle SQL files to JSON analysis...
2025-09-03 08:11:32,081 - root - DEBUG - [common.py:105] - Starting Step 1: Oracle SQL â†’ JSON conversion
2025-09-03 08:11:32,082 - root - INFO - [common.py:110] - === Starting Oracle triggers to JSON conversion ===
2025-09-03 08:11:32,083 - root - DEBUG - [common.py:105] - Workflow Phase 1: Convert Oracle SQL files to JSON analysis structure
2025-09-03 08:11:32,083 - root - DEBUG - [common.py:105] - Source directory: files/oracle
2025-09-03 08:11:32,083 - root - DEBUG - [common.py:105] - Target directory: files/format_json
2025-09-03 08:11:32,083 - root - DEBUG - [common.py:105] - File details will be included in metadata for each processed file
2025-09-03 08:11:32,083 - root - INFO - [common.py:110] - === Starting file processing ===
2025-09-03 08:11:32,083 - root - INFO - [common.py:110] - Source directory: 'files/oracle'
2025-09-03 08:11:32,084 - root - INFO - [common.py:110] - Target directory: 'files/format_json'
2025-09-03 08:11:32,084 - root - INFO - [common.py:110] - File pattern: '.sql'
2025-09-03 08:11:32,084 - root - INFO - [common.py:110] - Output suffix: '_analysis.json'
2025-09-03 08:11:32,084 - root - DEBUG - [common.py:105] - Ensuring target directory exists...
2025-09-03 08:11:32,084 - root - DEBUG - [common.py:105] - Directory already exists: files/format_json
2025-09-03 08:11:32,085 - root - DEBUG - [common.py:105] - Found 1 files in source directory
2025-09-03 08:11:32,085 - root - DEBUG - [common.py:105] - Files matching pattern '.sql': ['zzz.sql']
2025-09-03 08:11:32,085 - root - DEBUG - [common.py:105] - === Processing file 1/1: zzz.sql ===
2025-09-03 08:11:32,085 - root - DEBUG - [common.py:105] - Source path: files/oracle\zzz.sql
2025-09-03 08:11:32,085 - root - DEBUG - [common.py:105] - Output path: files/format_json\zzz_analysis.json
2025-09-03 08:11:32,085 - root - DEBUG - [common.py:105] - === SQL to JSON processing for trigger zzz.sql ===
2025-09-03 08:11:32,085 - root - DEBUG - [common.py:105] - Creating OracleTriggerAnalyzer instance from file...
2025-09-03 08:11:32,085 - root - DEBUG - [main.py:245] - Reading SQL file: files/oracle\zzz.sql
2025-09-03 08:11:32,085 - root - DEBUG - [common.py:105] - Initializing OracleTriggerAnalyzer with 20 characters of SQL
2025-09-03 08:11:32,085 - root - DEBUG - [OracleTriggerAnalyzer.py:106] - structured lines conversion 0 lines processed
2025-09-03 08:11:32,086 - root - DEBUG - [OracleTriggerAnalyzer.py:109] - SQL section parsing
2025-09-03 08:11:32,086 - root - DEBUG - [OracleTriggerAnalyzer.py:322] - structured lines conversion
2025-09-03 08:11:32,086 - root - DEBUG - [common.py:105] - Converting SQL content to structured lines
2025-09-03 08:11:32,086 - root - DEBUG - [common.py:105] - Structured lines conversion complete: 203 total, 45 with semicolons, 18 empty lines skipped
2025-09-03 08:11:32,086 - root - DEBUG - [OracleTriggerAnalyzer.py:324] - structured lines conversion
2025-09-03 08:11:32,086 - root - DEBUG - [OracleTriggerAnalyzer.py:261] - Block comment stripping complete: 0 comments extracted, 203 lines cleaned
2025-09-03 08:11:32,086 - root - DEBUG - [OracleTriggerAnalyzer.py:328] - Removed block comments from main section
2025-09-03 08:11:32,086 - root - DEBUG - [OracleTriggerAnalyzer.py:305] - Inline comment stripping complete: 18 comments extracted, 185 lines cleaned
2025-09-03 08:11:32,086 - root - DEBUG - [OracleTriggerAnalyzer.py:332] - Removed inline comments from main section
2025-09-03 08:11:32,086 - root - DEBUG - [OracleTriggerAnalyzer.py:344] - Found DECLARE at line 3
2025-09-03 08:11:32,086 - root - DEBUG - [OracleTriggerAnalyzer.py:348] - Found BEGIN at line 15
2025-09-03 08:11:32,086 - root - DEBUG - [OracleTriggerAnalyzer.py:358] - DECLARE section: lines 3-14
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:386] - Starting declaration parsing
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:464] - Processed exception: ERR_INS
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:464] - Processed exception: ERR_UPD
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:464] - Processed exception: ERR_UPD2
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:464] - Processed exception: ERR_UPD3
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:464] - Processed exception: ERR_UPD4
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:464] - Processed exception: ERR_DEL
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:464] - Processed exception: ERR_LEVEL
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:430] - Processed variable: V_HOLIDAY_DESCS
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:430] - Processed variable: V_COUNTRY_CODES
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:430] - Processed variable: V_CHK_IS_MULTIVALUE
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:430] - Processed variable: V_CHK_DISTINCT
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:1597] - Starting top-level BEGIN blocks parsing
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:1782] - exception_handler: [{'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 189}]}, {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 193}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 197}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 201}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 205}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 209}]}, {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 213}]}, {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 217}]}]
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:1642] - Begin line: {'indent': 12, 'line': '            BEGIN', 'line_no': 59} 32
2025-09-03 08:11:32,087 - root - DEBUG - [OracleTriggerAnalyzer.py:1649] - Exception line: {'indent': 12, 'line': '            EXCEPTION', 'line_no': 91} 64
2025-09-03 08:11:32,088 - root - DEBUG - [OracleTriggerAnalyzer.py:1652] - End line: {'indent': 12, 'line': '            END;', 'line_no': 98} 71
2025-09-03 08:11:32,088 - root - DEBUG - [OracleTriggerAnalyzer.py:1782] - exception_handler: [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'indent': 20, 'line': '                    IF SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 THEN', 'line_no': 93}, {'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}, {'indent': 20, 'line': '                    ELSE', 'line_no': 95}, {'indent': 24, 'line': '                        RAISE;', 'line_no': 96}, {'indent': 20, 'line': '                    END IF;', 'line_no': 97}]}]
2025-09-03 08:11:32,088 - root - DEBUG - [OracleTriggerAnalyzer.py:1642] - Begin line: {'indent': 12, 'line': '            BEGIN', 'line_no': 100} 73
2025-09-03 08:11:32,088 - root - DEBUG - [OracleTriggerAnalyzer.py:1649] - Exception line: {'indent': 12, 'line': '            EXCEPTION', 'line_no': 153} 126
2025-09-03 08:11:32,088 - root - DEBUG - [OracleTriggerAnalyzer.py:1652] - End line: {'indent': 12, 'line': '            END;', 'line_no': 160} 133
2025-09-03 08:11:32,088 - root - DEBUG - [OracleTriggerAnalyzer.py:1782] - exception_handler: [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 154, 'when_indent': 16, 'then_line_no': 154, 'exception_statements': [{'indent': 20, 'line': '                    IF SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 THEN', 'line_no': 155}, {'indent': 24, 'line': '                        RAISE ERR_UPD4;', 'line_no': 156}, {'indent': 20, 'line': '                    ELSE', 'line_no': 157}, {'indent': 24, 'line': '                        RAISE;', 'line_no': 158}, {'indent': 20, 'line': '                    END IF;', 'line_no': 159}]}]
2025-09-03 08:11:32,088 - root - INFO - [OracleTriggerAnalyzer.py:659] - with_indent: 21
2025-09-03 08:11:32,088 - root - INFO - [OracleTriggerAnalyzer.py:681] - with_i: 21 i: 52
2025-09-03 08:11:32,088 - root - DEBUG - [OracleTriggerAnalyzer.py:2119] - WITH C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )
2025-09-03 08:11:32,089 - root - DEBUG - [OracleTriggerAnalyzer.py:2119] - SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF;
2025-09-03 08:11:32,089 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 4, 'line': '    IF (INSERTING', 'line_no': 19}
2025-09-03 08:11:32,090 - root - DEBUG - [OracleTriggerAnalyzer.py:1222] - if_indent: 19
2025-09-03 08:11:32,090 - root - DEBUG - [OracleTriggerAnalyzer.py:1228] - if_i: 19 i: 182
2025-09-03 08:11:32,090 - root - DEBUG - [OracleTriggerAnalyzer.py:1229] - if_elses working_lines lenght: 26
2025-09-03 08:11:32,090 - root - DEBUG - [OracleTriggerAnalyzer.py:1311] - line_info : {'indent': 4, 'line': '    OR UPDATING) THEN', 'line_no': 20}
2025-09-03 08:11:32,090 - root - DEBUG - [OracleTriggerAnalyzer.py:1327] - then_statements: 0 18
2025-09-03 08:11:32,090 - root - DEBUG - [OracleTriggerAnalyzer.py:1333] - line_info: {'indent': 8, 'line': '        IF :OLD.HOLIDAY_DATE IS NULL THEN', 'line_no': 176}
2025-09-03 08:11:32,090 - root - DEBUG - [OracleTriggerAnalyzer.py:1333] - line_info: {'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}
2025-09-03 08:11:32,090 - root - DEBUG - [OracleTriggerAnalyzer.py:1333] - line_info: {'indent': 8, 'line': '        END IF;', 'line_no': 178}
2025-09-03 08:11:32,090 - root - DEBUG - [OracleTriggerAnalyzer.py:1333] - line_info: {'indent': 8, 'line': '        DELETE FROM CFG.CFG_IRTT_HOLIDAYS A', 'line_no': 179}
2025-09-03 08:11:32,091 - root - DEBUG - [OracleTriggerAnalyzer.py:1333] - line_info: {'indent': 8, 'line': '        WHERE', 'line_no': 180}
2025-09-03 08:11:32,091 - root - DEBUG - [OracleTriggerAnalyzer.py:1333] - line_info: {'indent': 12, 'line': '            A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'line_no': 181}
2025-09-03 08:11:32,091 - root - DEBUG - [OracleTriggerAnalyzer.py:1333] - line_info: {'indent': 4, 'line': '    END IF;', 'line_no': 182}
2025-09-03 08:11:32,091 - root - DEBUG - [OracleTriggerAnalyzer.py:1348] - {'indent': 4, 'line': '    ELSIF (DELETING) THEN', 'line_no': 175}
2025-09-03 08:11:32,091 - root - DEBUG - [OracleTriggerAnalyzer.py:1375] - elif_else_then_statements: [{'indent': 4, 'line': '    ELSIF (DELETING) THEN', 'line_no': 175}, {'indent': 8, 'line': '        IF :OLD.HOLIDAY_DATE IS NULL THEN', 'line_no': 176}, {'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}, {'indent': 8, 'line': '        END IF;', 'line_no': 178}, {'indent': 8, 'line': '        DELETE FROM CFG.CFG_IRTT_HOLIDAYS A', 'line_no': 179}, {'indent': 8, 'line': '        WHERE', 'line_no': 180}, {'indent': 12, 'line': '            A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'line_no': 181}]
2025-09-03 08:11:32,092 - root - DEBUG - [OracleTriggerAnalyzer.py:1376] - [{'indent': 4, 'line': '    ELSIF (DELETING) THEN', 'line_no': 175}, {'indent': 8, 'line': '        IF :OLD.HOLIDAY_DATE IS NULL THEN', 'line_no': 176}, {'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}, {'indent': 8, 'line': '        END IF;', 'line_no': 178}, {'indent': 8, 'line': '        DELETE FROM CFG.CFG_IRTT_HOLIDAYS A', 'line_no': 179}, {'indent': 8, 'line': '        WHERE', 'line_no': 180}, {'indent': 12, 'line': '            A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'line_no': 181}]
2025-09-03 08:11:32,092 - root - DEBUG - [OracleTriggerAnalyzer.py:1379] - elif_else_then_statements[0]: {'indent': 4, 'line': '    ELSIF (DELETING) THEN', 'line_no': 175}
2025-09-03 08:11:32,092 - root - DEBUG - [OracleTriggerAnalyzer.py:1406] - elif_else_then_statements 0: 175 then_i: 175
2025-09-03 08:11:32,092 - root - DEBUG - [OracleTriggerAnalyzer.py:1407] - case_when_then_statements: [{'indent': 4, 'line': '    ELSIF (DELETING) THEN', 'line_no': 175}, {'indent': 8, 'line': '        IF :OLD.HOLIDAY_DATE IS NULL THEN', 'line_no': 176}, {'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}, {'indent': 8, 'line': '        END IF;', 'line_no': 178}, {'indent': 8, 'line': '        DELETE FROM CFG.CFG_IRTT_HOLIDAYS A', 'line_no': 179}, {'indent': 8, 'line': '        WHERE', 'line_no': 180}, {'indent': 12, 'line': '            A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'line_no': 181}]
2025-09-03 08:11:32,092 - root - DEBUG - [OracleTriggerAnalyzer.py:1408] - elif_else_then_statements[0]['indent']: 4
2025-09-03 08:11:32,093 - root - DEBUG - [OracleTriggerAnalyzer.py:1365] - if_else_statements: {'condition': ' (INSERTING OR UPDATING) ', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'indent': 8, 'line': '        IF V_CHK_DISTINCT > 0 THEN', 'line_no': 54}, {'indent': 12, 'line': '            RAISE ERR_UPD3;', 'line_no': 55}, {'indent': 8, 'line': '        END IF;', 'line_no': 56}, {'indent': 8, 'line': '        IF V_CHK_IS_MULTIVALUE <= 1 THEN', 'line_no': 58}, {'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}, {'indent': 20, 'line': '                    SELECT', 'line_no': 61}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}, {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}, {'indent': 20, 'line': '                    FROM', 'line_no': 68}, {'indent': 24, 'line': '                        (', 'line_no': 69}, {'indent': 28, 'line': '                            SELECT', 'line_no': 70}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}, {'indent': 28, 'line': '                            FROM', 'line_no': 81}, {'indent': 32, 'line': '                                DUAL', 'line_no': 82}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'indent': 20, 'line': '                    IF SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 THEN', 'line_no': 93}, {'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}, {'indent': 20, 'line': '                    ELSE', 'line_no': 95}, {'indent': 24, 'line': '                        RAISE;', 'line_no': 96}, {'indent': 20, 'line': '                    END IF;', 'line_no': 97}]}], 'exception_line_no': 91, 'end_line_no': 98}, {'indent': 8, 'line': '        ELSE', 'line_no': 99}, {'type': 'begin_end', 'begin_line_no': 100, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( WITH HN AS (', 'line_no': 101}, {'indent': 20, 'line': '                    SELECT', 'line_no': 102}, {'indent': 24, 'line': '                        A.COLUMN_VALUE HOLIDAY_DESC,', 'line_no': 103}, {'indent': 24, 'line': '                        B.COLUMN_VALUE COUNTRY_CODE', 'line_no': 104}, {'indent': 20, 'line': '                    FROM', 'line_no': 105}, {'indent': 24, 'line': '                        (', 'line_no': 106}, {'indent': 28, 'line': '                            SELECT', 'line_no': 107}, {'indent': 32, 'line': '                                COLUMN_VALUE,', 'line_no': 108}, {'indent': 32, 'line': '                                ROWNUM       RN', 'line_no': 109}, {'indent': 28, 'line': '                            FROM', 'line_no': 110}, {'indent': 32, 'line': '                                TABLE(V_HOLIDAY_DESCS)', 'line_no': 111}, {'indent': 24, 'line': '                        ) A', 'line_no': 112}, {'indent': 24, 'line': '                        JOIN (', 'line_no': 113}, {'indent': 28, 'line': '                            SELECT', 'line_no': 114}, {'indent': 32, 'line': '                                COLUMN_VALUE,', 'line_no': 115}, {'indent': 32, 'line': '                                ROWNUM       RN', 'line_no': 116}, {'indent': 28, 'line': '                            FROM', 'line_no': 117}, {'indent': 32, 'line': '                                TABLE(V_COUNTRY_CODES)', 'line_no': 118}, {'indent': 24, 'line': '                        ) B', 'line_no': 119}, {'indent': 24, 'line': '                        ON A.RN = B.RN', 'line_no': 120}, {'indent': 16, 'line': '                )', 'line_no': 121}, {'indent': 20, 'line': '                    SELECT', 'line_no': 122}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 123}, {'indent': 24, 'line': "                        DECODE(VALID_IND, 'N', 'N/A', HOLIDAY_DESC) HOLIDAY_DESC,", 'line_no': 124}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 125}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 126}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 127}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 128}, {'indent': 20, 'line': '                    FROM', 'line_no': 129}, {'indent': 24, 'line': '                        (', 'line_no': 130}, {'indent': 28, 'line': '                            SELECT', 'line_no': 131}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 132}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 133}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 134}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 135}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 136}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 137}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 138}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 139}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 140}, {'indent': 28, 'line': '                            FROM', 'line_no': 141}, {'indent': 32, 'line': '                                DUAL', 'line_no': 142}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 143}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 144}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 145}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 146}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 147}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 148}, {'indent': 24, 'line': '                        LEFT JOIN HN', 'line_no': 149}, {'indent': 24, 'line': '                        ON HN.COUNTRY_CODE = COUNTRY_CD', 'line_no': 150}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 151}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 152}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 154, 'when_indent': 16, 'then_line_no': 154, 'exception_statements': [{'indent': 20, 'line': '                    IF SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 THEN', 'line_no': 155}, {'indent': 24, 'line': '                        RAISE ERR_UPD4;', 'line_no': 156}, {'indent': 20, 'line': '                    ELSE', 'line_no': 157}, {'indent': 24, 'line': '                        RAISE;', 'line_no': 158}, {'indent': 20, 'line': '                    END IF;', 'line_no': 159}]}], 'exception_line_no': 153, 'end_line_no': 160}, {'indent': 8, 'line': '        END IF;', 'line_no': 161}, {'indent': 8, 'line': '        IF (:NEW.GRANTED != :OLD.GRANTED) THEN', 'line_no': 166}, {'indent': 12, 'line': '            MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH(', 'line_no': 169}, {'indent': 16, 'line': '                P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE),', 'line_no': 170}, {'indent': 16, 'line': '                P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE),', 'line_no': 171}, {'indent': 16, 'line': '                P_START_EVENT_DATE => :NEW.HOLIDAY_DATE', 'line_no': 172}, {'indent': 12, 'line': '            );', 'line_no': 173}, {'indent': 8, 'line': '        END IF;', 'line_no': 174}], 'if_elses': [{'type': 'elif_statement', 'elif_line_no': 175, 'elif_indent': 4, 'condition': '(DELETING)', 'then_line_no': 175, 'then_statements': [{'indent': 8, 'line': '        IF :OLD.HOLIDAY_DATE IS NULL THEN', 'line_no': 176}, {'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}, {'indent': 8, 'line': '        END IF;', 'line_no': 178}, {'indent': 8, 'line': '        DELETE FROM CFG.CFG_IRTT_HOLIDAYS A', 'line_no': 179}, {'indent': 8, 'line': '        WHERE', 'line_no': 180}, {'indent': 12, 'line': '            A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'line_no': 181}]}], 'else_statements': []}
2025-09-03 08:11:32,093 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}
2025-09-03 08:11:32,093 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': '        IF V_CHK_DISTINCT > 0 THEN', 'line_no': 54}
2025-09-03 08:11:32,093 - root - DEBUG - [OracleTriggerAnalyzer.py:1222] - if_indent: 54
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1228] - if_i: 54 i: 56
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1229] - if_elses working_lines lenght: 3
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1362] - else_i: -1 elif_i: -1 then_statements: [{'indent': 12, 'line': '            RAISE ERR_UPD3;', 'line_no': 55}]
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1365] - if_else_statements: {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'indent': 12, 'line': '            RAISE ERR_UPD3;', 'line_no': 55}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 12, 'line': '            RAISE ERR_UPD3;', 'line_no': 55}
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': '        IF V_CHK_IS_MULTIVALUE <= 1 THEN', 'line_no': 58}
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1222] - if_indent: 58
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1228] - if_i: 58 i: 161
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1229] - if_elses working_lines lenght: 5
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1365] - if_else_statements: {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}, {'indent': 20, 'line': '                    SELECT', 'line_no': 61}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}, {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}, {'indent': 20, 'line': '                    FROM', 'line_no': 68}, {'indent': 24, 'line': '                        (', 'line_no': 69}, {'indent': 28, 'line': '                            SELECT', 'line_no': 70}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}, {'indent': 28, 'line': '                            FROM', 'line_no': 81}, {'indent': 32, 'line': '                                DUAL', 'line_no': 82}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'indent': 20, 'line': '                    IF SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 THEN', 'line_no': 93}, {'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}, {'indent': 20, 'line': '                    ELSE', 'line_no': 95}, {'indent': 24, 'line': '                        RAISE;', 'line_no': 96}, {'indent': 20, 'line': '                    END IF;', 'line_no': 97}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': [[{'type': 'begin_end', 'begin_line_no': 100, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( WITH HN AS (', 'line_no': 101}, {'indent': 20, 'line': '                    SELECT', 'line_no': 102}, {'indent': 24, 'line': '                        A.COLUMN_VALUE HOLIDAY_DESC,', 'line_no': 103}, {'indent': 24, 'line': '                        B.COLUMN_VALUE COUNTRY_CODE', 'line_no': 104}, {'indent': 20, 'line': '                    FROM', 'line_no': 105}, {'indent': 24, 'line': '                        (', 'line_no': 106}, {'indent': 28, 'line': '                            SELECT', 'line_no': 107}, {'indent': 32, 'line': '                                COLUMN_VALUE,', 'line_no': 108}, {'indent': 32, 'line': '                                ROWNUM       RN', 'line_no': 109}, {'indent': 28, 'line': '                            FROM', 'line_no': 110}, {'indent': 32, 'line': '                                TABLE(V_HOLIDAY_DESCS)', 'line_no': 111}, {'indent': 24, 'line': '                        ) A', 'line_no': 112}, {'indent': 24, 'line': '                        JOIN (', 'line_no': 113}, {'indent': 28, 'line': '                            SELECT', 'line_no': 114}, {'indent': 32, 'line': '                                COLUMN_VALUE,', 'line_no': 115}, {'indent': 32, 'line': '                                ROWNUM       RN', 'line_no': 116}, {'indent': 28, 'line': '                            FROM', 'line_no': 117}, {'indent': 32, 'line': '                                TABLE(V_COUNTRY_CODES)', 'line_no': 118}, {'indent': 24, 'line': '                        ) B', 'line_no': 119}, {'indent': 24, 'line': '                        ON A.RN = B.RN', 'line_no': 120}, {'indent': 16, 'line': '                )', 'line_no': 121}, {'indent': 20, 'line': '                    SELECT', 'line_no': 122}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 123}, {'indent': 24, 'line': "                        DECODE(VALID_IND, 'N', 'N/A', HOLIDAY_DESC) HOLIDAY_DESC,", 'line_no': 124}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 125}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 126}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 127}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 128}, {'indent': 20, 'line': '                    FROM', 'line_no': 129}, {'indent': 24, 'line': '                        (', 'line_no': 130}, {'indent': 28, 'line': '                            SELECT', 'line_no': 131}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 132}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 133}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 134}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 135}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 136}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 137}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 138}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 139}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 140}, {'indent': 28, 'line': '                            FROM', 'line_no': 141}, {'indent': 32, 'line': '                                DUAL', 'line_no': 142}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 143}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 144}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 145}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 146}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 147}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 148}, {'indent': 24, 'line': '                        LEFT JOIN HN', 'line_no': 149}, {'indent': 24, 'line': '                        ON HN.COUNTRY_CODE = COUNTRY_CD', 'line_no': 150}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 151}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 152}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 154, 'when_indent': 16, 'then_line_no': 154, 'exception_statements': [{'indent': 20, 'line': '                    IF SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 THEN', 'line_no': 155}, {'indent': 24, 'line': '                        RAISE ERR_UPD4;', 'line_no': 156}, {'indent': 20, 'line': '                    ELSE', 'line_no': 157}, {'indent': 24, 'line': '                        RAISE;', 'line_no': 158}, {'indent': 20, 'line': '                    END IF;', 'line_no': 159}]}], 'exception_line_no': 153, 'end_line_no': 160}, {'indent': 8, 'line': '        END IF;', 'line_no': 161}]]}
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}, {'indent': 20, 'line': '                    SELECT', 'line_no': 61}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}, {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}, {'indent': 20, 'line': '                    FROM', 'line_no': 68}, {'indent': 24, 'line': '                        (', 'line_no': 69}, {'indent': 28, 'line': '                            SELECT', 'line_no': 70}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}, {'indent': 28, 'line': '                            FROM', 'line_no': 81}, {'indent': 32, 'line': '                                DUAL', 'line_no': 82}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'indent': 20, 'line': '                    IF SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 THEN', 'line_no': 93}, {'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}, {'indent': 20, 'line': '                    ELSE', 'line_no': 95}, {'indent': 24, 'line': '                        RAISE;', 'line_no': 96}, {'indent': 20, 'line': '                    END IF;', 'line_no': 97}]}], 'exception_line_no': 91, 'end_line_no': 98}
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}
2025-09-03 08:11:32,094 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 20, 'line': '                    SELECT', 'line_no': 61}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 20, 'line': '                    FROM', 'line_no': 68}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': '                        (', 'line_no': 69}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 28, 'line': '                            SELECT', 'line_no': 70}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}
2025-09-03 08:11:32,095 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 28, 'line': '                            FROM', 'line_no': 81}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 32, 'line': '                                DUAL', 'line_no': 82}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 20, 'line': '                    IF SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 THEN', 'line_no': 93}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1222] - if_indent: 93
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1228] - if_i: 93 i: 97
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1229] - if_elses working_lines lenght: 5
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1365] - if_else_statements: {'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}], 'if_elses': [], 'else_statements': [[{'indent': 24, 'line': '                        RAISE;', 'line_no': 96}, {'indent': 20, 'line': '                    END IF;', 'line_no': 97}]]}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}
2025-09-03 08:11:32,096 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: [{'indent': 24, 'line': '                        RAISE;', 'line_no': 96}, {'indent': 20, 'line': '                    END IF;', 'line_no': 97}]
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: [{'type': 'begin_end', 'begin_line_no': 100, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( WITH HN AS (', 'line_no': 101}, {'indent': 20, 'line': '                    SELECT', 'line_no': 102}, {'indent': 24, 'line': '                        A.COLUMN_VALUE HOLIDAY_DESC,', 'line_no': 103}, {'indent': 24, 'line': '                        B.COLUMN_VALUE COUNTRY_CODE', 'line_no': 104}, {'indent': 20, 'line': '                    FROM', 'line_no': 105}, {'indent': 24, 'line': '                        (', 'line_no': 106}, {'indent': 28, 'line': '                            SELECT', 'line_no': 107}, {'indent': 32, 'line': '                                COLUMN_VALUE,', 'line_no': 108}, {'indent': 32, 'line': '                                ROWNUM       RN', 'line_no': 109}, {'indent': 28, 'line': '                            FROM', 'line_no': 110}, {'indent': 32, 'line': '                                TABLE(V_HOLIDAY_DESCS)', 'line_no': 111}, {'indent': 24, 'line': '                        ) A', 'line_no': 112}, {'indent': 24, 'line': '                        JOIN (', 'line_no': 113}, {'indent': 28, 'line': '                            SELECT', 'line_no': 114}, {'indent': 32, 'line': '                                COLUMN_VALUE,', 'line_no': 115}, {'indent': 32, 'line': '                                ROWNUM       RN', 'line_no': 116}, {'indent': 28, 'line': '                            FROM', 'line_no': 117}, {'indent': 32, 'line': '                                TABLE(V_COUNTRY_CODES)', 'line_no': 118}, {'indent': 24, 'line': '                        ) B', 'line_no': 119}, {'indent': 24, 'line': '                        ON A.RN = B.RN', 'line_no': 120}, {'indent': 16, 'line': '                )', 'line_no': 121}, {'indent': 20, 'line': '                    SELECT', 'line_no': 122}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 123}, {'indent': 24, 'line': "                        DECODE(VALID_IND, 'N', 'N/A', HOLIDAY_DESC) HOLIDAY_DESC,", 'line_no': 124}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 125}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 126}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 127}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 128}, {'indent': 20, 'line': '                    FROM', 'line_no': 129}, {'indent': 24, 'line': '                        (', 'line_no': 130}, {'indent': 28, 'line': '                            SELECT', 'line_no': 131}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 132}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 133}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 134}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 135}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 136}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 137}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 138}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 139}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 140}, {'indent': 28, 'line': '                            FROM', 'line_no': 141}, {'indent': 32, 'line': '                                DUAL', 'line_no': 142}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 143}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 144}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 145}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 146}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 147}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 148}, {'indent': 24, 'line': '                        LEFT JOIN HN', 'line_no': 149}, {'indent': 24, 'line': '                        ON HN.COUNTRY_CODE = COUNTRY_CD', 'line_no': 150}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 151}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 152}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 154, 'when_indent': 16, 'then_line_no': 154, 'exception_statements': [{'indent': 20, 'line': '                    IF SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 THEN', 'line_no': 155}, {'indent': 24, 'line': '                        RAISE ERR_UPD4;', 'line_no': 156}, {'indent': 20, 'line': '                    ELSE', 'line_no': 157}, {'indent': 24, 'line': '                        RAISE;', 'line_no': 158}, {'indent': 20, 'line': '                    END IF;', 'line_no': 159}]}], 'exception_line_no': 153, 'end_line_no': 160}, {'indent': 8, 'line': '        END IF;', 'line_no': 161}]
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': '        IF (:NEW.GRANTED != :OLD.GRANTED) THEN', 'line_no': 166}
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1222] - if_indent: 166
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1228] - if_i: 166 i: 174
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1229] - if_elses working_lines lenght: 7
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1362] - else_i: -1 elif_i: -1 then_statements: [{'indent': 12, 'line': '            MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH(', 'line_no': 169}, {'indent': 16, 'line': '                P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE),', 'line_no': 170}, {'indent': 16, 'line': '                P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE),', 'line_no': 171}, {'indent': 16, 'line': '                P_START_EVENT_DATE => :NEW.HOLIDAY_DATE', 'line_no': 172}, {'indent': 12, 'line': '            );', 'line_no': 173}]
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1365] - if_else_statements: {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'indent': 12, 'line': '            MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH(', 'line_no': 169}, {'indent': 16, 'line': '                P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE),', 'line_no': 170}, {'indent': 16, 'line': '                P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE),', 'line_no': 171}, {'indent': 16, 'line': '                P_START_EVENT_DATE => :NEW.HOLIDAY_DATE', 'line_no': 172}, {'indent': 12, 'line': '            );', 'line_no': 173}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 12, 'line': '            MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH(', 'line_no': 169}
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 16, 'line': '                P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE),', 'line_no': 170}
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 16, 'line': '                P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE),', 'line_no': 171}
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 16, 'line': '                P_START_EVENT_DATE => :NEW.HOLIDAY_DATE', 'line_no': 172}
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 12, 'line': '            );', 'line_no': 173}
2025-09-03 08:11:32,097 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': '        IF :OLD.HOLIDAY_DATE IS NULL THEN', 'line_no': 176}
2025-09-03 08:11:32,098 - root - DEBUG - [OracleTriggerAnalyzer.py:1222] - if_indent: 176
2025-09-03 08:11:32,098 - root - DEBUG - [OracleTriggerAnalyzer.py:1228] - if_i: 176 i: 178
2025-09-03 08:11:32,098 - root - DEBUG - [OracleTriggerAnalyzer.py:1229] - if_elses working_lines lenght: 3
2025-09-03 08:11:32,098 - root - DEBUG - [OracleTriggerAnalyzer.py:1362] - else_i: -1 elif_i: -1 then_statements: [{'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}]
2025-09-03 08:11:32,098 - root - DEBUG - [OracleTriggerAnalyzer.py:1365] - if_else_statements: {'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:32,098 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}
2025-09-03 08:11:32,098 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': '        DELETE FROM CFG.CFG_IRTT_HOLIDAYS A', 'line_no': 179}
2025-09-03 08:11:32,098 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': '        WHERE', 'line_no': 180}
2025-09-03 08:11:32,098 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 12, 'line': '            A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'line_no': 181}
2025-09-03 08:11:32,098 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 189}
2025-09-03 08:11:32,099 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 193}
2025-09-03 08:11:32,099 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 197}
2025-09-03 08:11:32,099 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 201}
2025-09-03 08:11:32,099 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 205}
2025-09-03 08:11:32,099 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 209}
2025-09-03 08:11:32,099 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 213}
2025-09-03 08:11:32,099 - root - DEBUG - [OracleTriggerAnalyzer.py:1218] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 217}
2025-09-03 08:11:32,830 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'condition': ' (INSERTING OR UPDATING) ', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'indent': 12, 'line': '            RAISE ERR_UPD3;', 'line_no': 55}], 'if_elses': [], 'else_statements': []}, {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}, {'indent': 20, 'line': '                    SELECT', 'line_no': 61}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}, {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}, {'indent': 20, 'line': '                    FROM', 'line_no': 68}, {'indent': 24, 'line': '                        (', 'line_no': 69}, {'indent': 28, 'line': '                            SELECT', 'line_no': 70}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}, {'indent': 28, 'line': '                            FROM', 'line_no': 81}, {'indent': 32, 'line': '                                DUAL', 'line_no': 82}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'indent': 12, 'line': '            MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH(', 'line_no': 169}, {'indent': 16, 'line': '                P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE),', 'line_no': 170}, {'indent': 16, 'line': '                P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE),', 'line_no': 171}, {'indent': 16, 'line': '                P_START_EVENT_DATE => :NEW.HOLIDAY_DATE', 'line_no': 172}, {'indent': 12, 'line': '            );', 'line_no': 173}], 'if_elses': [], 'else_statements': []}], 'if_elses': [{'type': 'elif_statement', 'elif_line_no': 175, 'elif_indent': 4, 'condition': '(DELETING)', 'then_line_no': 175, 'then_statements': [{'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}], 'if_elses': [], 'else_statements': []}, {'indent': 8, 'line': '        DELETE FROM CFG.CFG_IRTT_HOLIDAYS A', 'line_no': 179}, {'indent': 8, 'line': '        WHERE', 'line_no': 180}, {'indent': 12, 'line': '            A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'line_no': 181}]}], 'else_statements': []}]
2025-09-03 08:11:32,830 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:32,850 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'indent': 12, 'line': '            RAISE ERR_UPD3;', 'line_no': 55}], 'if_elses': [], 'else_statements': []}, {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}, {'indent': 20, 'line': '                    SELECT', 'line_no': 61}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}, {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}, {'indent': 20, 'line': '                    FROM', 'line_no': 68}, {'indent': 24, 'line': '                        (', 'line_no': 69}, {'indent': 28, 'line': '                            SELECT', 'line_no': 70}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}, {'indent': 28, 'line': '                            FROM', 'line_no': 81}, {'indent': 32, 'line': '                                DUAL', 'line_no': 82}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'indent': 12, 'line': '            MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH(', 'line_no': 169}, {'indent': 16, 'line': '                P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE),', 'line_no': 170}, {'indent': 16, 'line': '                P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE),', 'line_no': 171}, {'indent': 16, 'line': '                P_START_EVENT_DATE => :NEW.HOLIDAY_DATE', 'line_no': 172}, {'indent': 12, 'line': '            );', 'line_no': 173}], 'if_elses': [], 'else_statements': []}]
2025-09-03 08:11:32,851 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:32,851 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 1
2025-09-03 08:11:32,861 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 12, 'line': '            RAISE ERR_UPD3;', 'line_no': 55}]
2025-09-03 08:11:32,861 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:32,861 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 12, 'line': '            RAISE ERR_UPD3;', 'line_no': 55}
2025-09-03 08:11:32,870 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: []
2025-09-03 08:11:32,871 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 2
2025-09-03 08:11:32,885 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}, {'indent': 20, 'line': '                    SELECT', 'line_no': 61}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}, {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}, {'indent': 20, 'line': '                    FROM', 'line_no': 68}, {'indent': 24, 'line': '                        (', 'line_no': 69}, {'indent': 28, 'line': '                            SELECT', 'line_no': 70}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}, {'indent': 28, 'line': '                            FROM', 'line_no': 81}, {'indent': 32, 'line': '                                DUAL', 'line_no': 82}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}]
2025-09-03 08:11:32,885 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:32,905 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}, {'indent': 20, 'line': '                    SELECT', 'line_no': 61}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}, {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}, {'indent': 20, 'line': '                    FROM', 'line_no': 68}, {'indent': 24, 'line': '                        (', 'line_no': 69}, {'indent': 28, 'line': '                            SELECT', 'line_no': 70}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}, {'indent': 28, 'line': '                            FROM', 'line_no': 81}, {'indent': 32, 'line': '                                DUAL', 'line_no': 82}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}]
2025-09-03 08:11:32,905 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 1
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 20, 'line': '                    SELECT', 'line_no': 61}
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 2
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 3
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 4
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 5
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}
2025-09-03 08:11:32,906 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 6
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 7
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 8
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 20, 'line': '                    FROM', 'line_no': 68}
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 9
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': '                        (', 'line_no': 69}
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 10
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 28, 'line': '                            SELECT', 'line_no': 70}
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 11
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 12
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}
2025-09-03 08:11:32,907 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 13
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 14
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 15
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 16
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 17
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 18
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 19
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}
2025-09-03 08:11:32,908 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 20
2025-09-03 08:11:32,909 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}
2025-09-03 08:11:32,909 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 21
2025-09-03 08:11:32,909 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 28, 'line': '                            FROM', 'line_no': 81}
2025-09-03 08:11:32,909 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 22
2025-09-03 08:11:32,909 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 32, 'line': '                                DUAL', 'line_no': 82}
2025-09-03 08:11:32,910 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 23
2025-09-03 08:11:32,910 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}
2025-09-03 08:11:32,910 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 24
2025-09-03 08:11:32,910 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}
2025-09-03 08:11:32,910 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 25
2025-09-03 08:11:32,911 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}
2025-09-03 08:11:32,911 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 26
2025-09-03 08:11:32,911 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}
2025-09-03 08:11:32,911 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 27
2025-09-03 08:11:32,911 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}
2025-09-03 08:11:32,911 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 28
2025-09-03 08:11:32,912 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}
2025-09-03 08:11:32,912 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 29
2025-09-03 08:11:32,912 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}
2025-09-03 08:11:32,912 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 30
2025-09-03 08:11:32,912 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}
2025-09-03 08:11:32,927 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}], 'if_elses': [], 'else_statements': []}]
2025-09-03 08:11:32,927 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:32,943 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}]
2025-09-03 08:11:32,943 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:32,943 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}
2025-09-03 08:11:32,955 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: []
2025-09-03 08:11:32,965 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: []
2025-09-03 08:11:32,965 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 3
2025-09-03 08:11:32,981 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 12, 'line': '            MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH(', 'line_no': 169}, {'indent': 16, 'line': '                P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE),', 'line_no': 170}, {'indent': 16, 'line': '                P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE),', 'line_no': 171}, {'indent': 16, 'line': '                P_START_EVENT_DATE => :NEW.HOLIDAY_DATE', 'line_no': 172}, {'indent': 12, 'line': '            );', 'line_no': 173}]
2025-09-03 08:11:32,981 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:32,981 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 12, 'line': '            MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH(', 'line_no': 169}
2025-09-03 08:11:32,981 - root - DEBUG - [OracleTriggerAnalyzer.py:842] - function_calling_name: MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH
2025-09-03 08:11:32,981 - root - DEBUG - [OracleTriggerAnalyzer.py:849] - item: MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH(
2025-09-03 08:11:32,981 - root - DEBUG - [OracleTriggerAnalyzer.py:850] - function calling start: 169
2025-09-03 08:11:32,981 - root - DEBUG - [OracleTriggerAnalyzer.py:863] - function calling end: 173
2025-09-03 08:11:32,981 - root - DEBUG - [OracleTriggerAnalyzer.py:2119] - MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH( P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE );
2025-09-03 08:11:32,982 - root - DEBUG - [OracleTriggerAnalyzer.py:1800] - combined_line: MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH( P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE );
2025-09-03 08:11:32,982 - root - DEBUG - [OracleTriggerAnalyzer.py:1830] - function_calling: {'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}
2025-09-03 08:11:32,993 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: []
2025-09-03 08:11:33,004 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}], 'if_elses': [], 'else_statements': []}, {'indent': 8, 'line': '        DELETE FROM CFG.CFG_IRTT_HOLIDAYS A', 'line_no': 179}, {'indent': 8, 'line': '        WHERE', 'line_no': 180}, {'indent': 12, 'line': '            A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'line_no': 181}]
2025-09-03 08:11:33,004 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:33,023 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}]
2025-09-03 08:11:33,023 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:33,023 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}
2025-09-03 08:11:33,033 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: []
2025-09-03 08:11:33,033 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 1
2025-09-03 08:11:33,034 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 8, 'line': '        DELETE FROM CFG.CFG_IRTT_HOLIDAYS A', 'line_no': 179}
2025-09-03 08:11:33,034 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 2
2025-09-03 08:11:33,034 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 8, 'line': '        WHERE', 'line_no': 180}
2025-09-03 08:11:33,034 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 3
2025-09-03 08:11:33,034 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 12, 'line': '            A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'line_no': 181}
2025-09-03 08:11:33,044 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: []
2025-09-03 08:11:33,056 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 189}]
2025-09-03 08:11:33,056 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:33,056 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 189}
2025-09-03 08:11:33,056 - root - DEBUG - [OracleTriggerAnalyzer.py:842] - function_calling_name: RAISE_APPLICATION_ERROR
2025-09-03 08:11:33,056 - root - DEBUG - [OracleTriggerAnalyzer.py:849] - item: RAISE_APPLICATION_ERROR (-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,056 - root - DEBUG - [OracleTriggerAnalyzer.py:850] - function calling start: 189
2025-09-03 08:11:33,056 - root - DEBUG - [OracleTriggerAnalyzer.py:852] - function calling end: 189
2025-09-03 08:11:33,056 - root - DEBUG - [OracleTriggerAnalyzer.py:1800] - combined_line: RAISE_APPLICATION_ERROR (-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,056 - root - DEBUG - [OracleTriggerAnalyzer.py:1830] - function_calling: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,067 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 193}]
2025-09-03 08:11:33,067 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:33,067 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 193}
2025-09-03 08:11:33,067 - root - DEBUG - [OracleTriggerAnalyzer.py:842] - function_calling_name: RAISE_APPLICATION_ERROR
2025-09-03 08:11:33,067 - root - DEBUG - [OracleTriggerAnalyzer.py:849] - item: RAISE_APPLICATION_ERROR (-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,067 - root - DEBUG - [OracleTriggerAnalyzer.py:850] - function calling start: 193
2025-09-03 08:11:33,067 - root - DEBUG - [OracleTriggerAnalyzer.py:852] - function calling end: 193
2025-09-03 08:11:33,067 - root - DEBUG - [OracleTriggerAnalyzer.py:1800] - combined_line: RAISE_APPLICATION_ERROR (-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,067 - root - DEBUG - [OracleTriggerAnalyzer.py:1830] - function_calling: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,077 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 197}]
2025-09-03 08:11:33,077 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:33,077 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 197}
2025-09-03 08:11:33,077 - root - DEBUG - [OracleTriggerAnalyzer.py:842] - function_calling_name: RAISE_APPLICATION_ERROR
2025-09-03 08:11:33,077 - root - DEBUG - [OracleTriggerAnalyzer.py:849] - item: RAISE_APPLICATION_ERROR (-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,077 - root - DEBUG - [OracleTriggerAnalyzer.py:850] - function calling start: 197
2025-09-03 08:11:33,077 - root - DEBUG - [OracleTriggerAnalyzer.py:852] - function calling end: 197
2025-09-03 08:11:33,077 - root - DEBUG - [OracleTriggerAnalyzer.py:1800] - combined_line: RAISE_APPLICATION_ERROR (-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,077 - root - DEBUG - [OracleTriggerAnalyzer.py:1830] - function_calling: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,089 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 201}]
2025-09-03 08:11:33,089 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:33,090 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 201}
2025-09-03 08:11:33,090 - root - DEBUG - [OracleTriggerAnalyzer.py:842] - function_calling_name: RAISE_APPLICATION_ERROR
2025-09-03 08:11:33,090 - root - DEBUG - [OracleTriggerAnalyzer.py:849] - item: RAISE_APPLICATION_ERROR (-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,090 - root - DEBUG - [OracleTriggerAnalyzer.py:850] - function calling start: 201
2025-09-03 08:11:33,090 - root - DEBUG - [OracleTriggerAnalyzer.py:852] - function calling end: 201
2025-09-03 08:11:33,090 - root - DEBUG - [OracleTriggerAnalyzer.py:1800] - combined_line: RAISE_APPLICATION_ERROR (-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,090 - root - DEBUG - [OracleTriggerAnalyzer.py:1830] - function_calling: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,102 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 205}]
2025-09-03 08:11:33,102 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:33,102 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 205}
2025-09-03 08:11:33,102 - root - DEBUG - [OracleTriggerAnalyzer.py:842] - function_calling_name: RAISE_APPLICATION_ERROR
2025-09-03 08:11:33,102 - root - DEBUG - [OracleTriggerAnalyzer.py:849] - item: RAISE_APPLICATION_ERROR (-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,102 - root - DEBUG - [OracleTriggerAnalyzer.py:850] - function calling start: 205
2025-09-03 08:11:33,102 - root - DEBUG - [OracleTriggerAnalyzer.py:852] - function calling end: 205
2025-09-03 08:11:33,103 - root - DEBUG - [OracleTriggerAnalyzer.py:1800] - combined_line: RAISE_APPLICATION_ERROR (-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,103 - root - DEBUG - [OracleTriggerAnalyzer.py:1830] - function_calling: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,118 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 209}]
2025-09-03 08:11:33,118 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:33,119 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 209}
2025-09-03 08:11:33,119 - root - DEBUG - [OracleTriggerAnalyzer.py:842] - function_calling_name: RAISE_APPLICATION_ERROR
2025-09-03 08:11:33,119 - root - DEBUG - [OracleTriggerAnalyzer.py:849] - item: RAISE_APPLICATION_ERROR (-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,119 - root - DEBUG - [OracleTriggerAnalyzer.py:850] - function calling start: 209
2025-09-03 08:11:33,119 - root - DEBUG - [OracleTriggerAnalyzer.py:852] - function calling end: 209
2025-09-03 08:11:33,119 - root - DEBUG - [OracleTriggerAnalyzer.py:1800] - combined_line: RAISE_APPLICATION_ERROR (-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,119 - root - DEBUG - [OracleTriggerAnalyzer.py:1830] - function_calling: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,133 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 213}]
2025-09-03 08:11:33,133 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:33,133 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 213}
2025-09-03 08:11:33,133 - root - DEBUG - [OracleTriggerAnalyzer.py:842] - function_calling_name: RAISE_APPLICATION_ERROR
2025-09-03 08:11:33,133 - root - DEBUG - [OracleTriggerAnalyzer.py:849] - item: RAISE_APPLICATION_ERROR (-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,133 - root - DEBUG - [OracleTriggerAnalyzer.py:850] - function calling start: 213
2025-09-03 08:11:33,133 - root - DEBUG - [OracleTriggerAnalyzer.py:852] - function calling end: 213
2025-09-03 08:11:33,133 - root - DEBUG - [OracleTriggerAnalyzer.py:1800] - combined_line: RAISE_APPLICATION_ERROR (-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,133 - root - DEBUG - [OracleTriggerAnalyzer.py:1830] - function_calling: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,143 - root - DEBUG - [OracleTriggerAnalyzer.py:807] - working_lines: [{'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 217}]
2025-09-03 08:11:33,143 - root - DEBUG - [OracleTriggerAnalyzer.py:813] - i: 0
2025-09-03 08:11:33,143 - root - DEBUG - [OracleTriggerAnalyzer.py:816] - item: {'indent': 8, 'line': "        RAISE_APPLICATION_ERROR (-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');", 'line_no': 217}
2025-09-03 08:11:33,143 - root - DEBUG - [OracleTriggerAnalyzer.py:842] - function_calling_name: RAISE_APPLICATION_ERROR
2025-09-03 08:11:33,143 - root - DEBUG - [OracleTriggerAnalyzer.py:849] - item: RAISE_APPLICATION_ERROR (-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,143 - root - DEBUG - [OracleTriggerAnalyzer.py:850] - function calling start: 217
2025-09-03 08:11:33,143 - root - DEBUG - [OracleTriggerAnalyzer.py:852] - function calling end: 217
2025-09-03 08:11:33,143 - root - DEBUG - [OracleTriggerAnalyzer.py:1800] - combined_line: RAISE_APPLICATION_ERROR (-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF');
2025-09-03 08:11:33,143 - root - DEBUG - [OracleTriggerAnalyzer.py:1830] - function_calling: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'condition': ' (INSERTING OR UPDATING) ', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'indent': 12, 'line': '            RAISE ERR_UPD3;', 'line_no': 55}], 'if_elses': [], 'else_statements': []}, {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}, {'indent': 20, 'line': '                    SELECT', 'line_no': 61}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}, {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}, {'indent': 20, 'line': '                    FROM', 'line_no': 68}, {'indent': 24, 'line': '                        (', 'line_no': 69}, {'indent': 28, 'line': '                            SELECT', 'line_no': 70}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}, {'indent': 28, 'line': '                            FROM', 'line_no': 81}, {'indent': 32, 'line': '                                DUAL', 'line_no': 82}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [{'type': 'elif_statement', 'elif_line_no': 175, 'elif_indent': 4, 'condition': '(DELETING)', 'then_line_no': 175, 'then_statements': [{'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}], 'if_elses': [], 'else_statements': []}, {'indent': 8, 'line': '        DELETE FROM CFG.CFG_IRTT_HOLIDAYS A', 'line_no': 179}, {'indent': 8, 'line': '        WHERE', 'line_no': 180}, {'indent': 12, 'line': '            A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'line_no': 181}]}], 'else_statements': []}]
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'indent': 12, 'line': '            RAISE ERR_UPD3;', 'line_no': 55}], 'if_elses': [], 'else_statements': []}, {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}, {'indent': 20, 'line': '                    SELECT', 'line_no': 61}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}, {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}, {'indent': 20, 'line': '                    FROM', 'line_no': 68}, {'indent': 24, 'line': '                        (', 'line_no': 69}, {'indent': 28, 'line': '                            SELECT', 'line_no': 70}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}, {'indent': 28, 'line': '                            FROM', 'line_no': 81}, {'indent': 32, 'line': '                                DUAL', 'line_no': 82}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}]
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 1
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'indent': 12, 'line': '            RAISE ERR_UPD3;', 'line_no': 55}]
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:953] - item:             RAISE ERR_UPD3; || 55 || 12
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:963] - stmt start: 55 || raise_statement || RAISE
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:966] - stmt start: 55 || raise_statement
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:969] - stmt start: 55 || raise_statement
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:971] - stmt end: 55 || raise_statement
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: []
2025-09-03 08:11:33,144 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 2
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}, {'indent': 20, 'line': '                    SELECT', 'line_no': 61}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}, {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}, {'indent': 20, 'line': '                    FROM', 'line_no': 68}, {'indent': 24, 'line': '                        (', 'line_no': 69}, {'indent': 28, 'line': '                            SELECT', 'line_no': 70}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}, {'indent': 28, 'line': '                            FROM', 'line_no': 81}, {'indent': 32, 'line': '                                DUAL', 'line_no': 82}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}]
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'indent': 16, 'line': '                MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING (', 'line_no': 60}, {'indent': 20, 'line': '                    SELECT', 'line_no': 61}, {'indent': 24, 'line': '                        HOLIDAY_DATE,', 'line_no': 62}, {'indent': 24, 'line': '                        HOLIDAY_DESC,', 'line_no': 63}, {'indent': 24, 'line': '                        GRANTED,', 'line_no': 64}, {'indent': 24, 'line': '                        COUNTRY_CD,', 'line_no': 65}, {'indent': 24, 'line': '                        HOLIDAY_REMARKS,', 'line_no': 66}, {'indent': 24, 'line': '                        VALID_IND', 'line_no': 67}, {'indent': 20, 'line': '                    FROM', 'line_no': 68}, {'indent': 24, 'line': '                        (', 'line_no': 69}, {'indent': 28, 'line': '                            SELECT', 'line_no': 70}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_DATE    HOLIDAY_DATE,', 'line_no': 71}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_NAME    HOLIDAY_DESC,', 'line_no': 72}, {'indent': 32, 'line': '                                :NEW.GRANTED         GRANTED,', 'line_no': 73}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_CH    CH,', 'line_no': 74}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_USA   USA,', 'line_no': 75}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_UK    UK,', 'line_no': 76}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_FR    FR,', 'line_no': 77}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_DE    DE,', 'line_no': 78}, {'indent': 32, 'line': '                                :NEW.VALID_FOR_JP    JP,', 'line_no': 79}, {'indent': 32, 'line': '                                :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS', 'line_no': 80}, {'indent': 28, 'line': '                            FROM', 'line_no': 81}, {'indent': 32, 'line': '                                DUAL', 'line_no': 82}, {'indent': 24, 'line': "                        )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH',", 'line_no': 83}, {'indent': 24, 'line': "                        USA AS 'US',", 'line_no': 84}, {'indent': 24, 'line': "                        UK AS 'GB',", 'line_no': 85}, {'indent': 24, 'line': "                        FR AS 'FR',", 'line_no': 86}, {'indent': 24, 'line': "                        DE AS 'DE',", 'line_no': 87}, {'indent': 24, 'line': "                        JP AS 'JP'))", 'line_no': 88}, {'indent': 16, 'line': '                ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE', 'line_no': 89}, {'indent': 16, 'line': '                AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);', 'line_no': 90}]
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:953] - item:                 MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( || 60 || 16
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:963] - stmt start: 60 || merge_statement || MERGE
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:966] - stmt start: 60 || merge_statement
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:969] - stmt start: 60 || merge_statement
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:979] - stmt end: 90 || merge_statement
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:2119] - MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}], 'if_elses': [], 'else_statements': []}]
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'indent': 24, 'line': '                        RAISE ERR_INS;', 'line_no': 94}]
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:953] - item:                         RAISE ERR_INS; || 94 || 24
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:963] - stmt start: 94 || raise_statement || RAISE
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:966] - stmt start: 94 || raise_statement
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:969] - stmt start: 94 || raise_statement
2025-09-03 08:11:33,145 - root - DEBUG - [OracleTriggerAnalyzer.py:971] - stmt end: 94 || raise_statement
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: []
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: []
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 3
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}]
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: []
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}], 'if_elses': [], 'else_statements': []}, {'indent': 8, 'line': '        DELETE FROM CFG.CFG_IRTT_HOLIDAYS A', 'line_no': 179}, {'indent': 8, 'line': '        WHERE', 'line_no': 180}, {'indent': 12, 'line': '            A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'line_no': 181}]
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'indent': 12, 'line': '            RAISE ERR_DEL;', 'line_no': 177}]
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:953] - item:             RAISE ERR_DEL; || 177 || 12
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:963] - stmt start: 177 || raise_statement || RAISE
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:966] - stmt start: 177 || raise_statement
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:969] - stmt start: 177 || raise_statement
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:971] - stmt end: 177 || raise_statement
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: []
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 1
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:953] - item:         DELETE FROM CFG.CFG_IRTT_HOLIDAYS A || 179 || 8
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:963] - stmt start: 179 || delete_statement || DELETE
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:966] - stmt start: 179 || delete_statement
2025-09-03 08:11:33,146 - root - DEBUG - [OracleTriggerAnalyzer.py:969] - stmt start: 179 || delete_statement
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:979] - stmt end: 181 || delete_statement
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:2119] - DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: []
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:948] - working_lines: [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]
2025-09-03 08:11:33,147 - root - DEBUG - [OracleTriggerAnalyzer.py:950] - i: 0
2025-09-03 08:11:33,148 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'begin_end', 'begin_line_no': 15, 'begin_indent': 0, 'begin_end_statements': [{'condition': ' (INSERTING OR UPDATING) ', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [{'type': 'elif_statement', 'elif_line_no': 175, 'elif_indent': 4, 'condition': '(DELETING)', 'then_line_no': 175, 'then_statements': [{'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}]}], 'else_statements': []}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}], 'exception_line_no': 183, 'end_line_no': 218}
2025-09-03 08:11:33,148 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'condition': ' (INSERTING OR UPDATING) ', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [{'type': 'elif_statement', 'elif_line_no': 175, 'elif_indent': 4, 'condition': '(DELETING)', 'then_line_no': 175, 'then_statements': [{'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}]}], 'else_statements': []}
2025-09-03 08:11:33,148 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}
2025-09-03 08:11:33,148 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,148 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}
2025-09-03 08:11:33,148 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,148 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}
2025-09-03 08:11:33,148 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}
2025-09-03 08:11:33,148 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}
2025-09-03 08:11:33,148 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,148 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}
2025-09-03 08:11:33,149 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,149 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}
2025-09-03 08:11:33,149 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'elif_statement', 'elif_line_no': 175, 'elif_indent': 4, 'condition': '(DELETING)', 'then_line_no': 175, 'then_statements': [{'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}]}
2025-09-03 08:11:33,149 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,149 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}
2025-09-03 08:11:33,149 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}
2025-09-03 08:11:33,149 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,149 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,149 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,149 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,149 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,150 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,150 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,150 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,150 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,150 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,150 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,150 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,150 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,150 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,151 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,151 - root - DEBUG - [OracleTriggerAnalyzer.py:2150] - item: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,151 - root - DEBUG - [OracleTriggerAnalyzer.py:2163] - rest_strings_list []
2025-09-03 08:11:33,156 - root - DEBUG - [OracleTriggerAnalyzer.py:2170] - dataframe_rest_strings: Empty DataFrame
Columns: [filename, line, line_no]
Index: []
2025-09-03 08:11:33,156 - root - DEBUG - [OracleTriggerAnalyzer.py:111] - SQL section parsing
2025-09-03 08:11:33,156 - root - DEBUG - [OracleTriggerAnalyzer.py:114] - OracleTriggerAnalyzer initialization 1.0711071491241455 seconds
2025-09-03 08:11:33,156 - root - DEBUG - [common.py:105] - OracleTriggerAnalyzer created successfully with file details
2025-09-03 08:11:33,156 - root - DEBUG - [common.py:105] - File details: zzz.sql
2025-09-03 08:11:33,156 - root - DEBUG - [common.py:105] - Generating JSON analysis...
2025-09-03 08:11:33,156 - root - DEBUG - [OracleTriggerAnalyzer.py:2221] - JSON conversion complete: 4 vars, 0 consts, 7 excs, 18 comments
2025-09-03 08:11:33,156 - root - DEBUG - [common.py:105] - JSON analysis generated successfully
2025-09-03 08:11:33,156 - root - DEBUG - [common.py:105] - Generated JSON with keys: ['declarations', 'main', 'sql_comments', 'rest_string_list', 'conversion_stats', 'metadata']
2025-09-03 08:11:33,157 - root - DEBUG - [common.py:105] - File details in metadata: zzz.sql (9115 bytes)
2025-09-03 08:11:33,157 - root - DEBUG - [common.py:105] - Analysis statistics: 4 vars, 0 consts, 7 excs, 18 comments
2025-09-03 08:11:33,157 - root - DEBUG - [common.py:105] - Writing analysis JSON to: files/format_json\zzz_analysis.json
2025-09-03 08:11:33,158 - root - DEBUG - [common.py:105] - Successfully wrote analysis JSON to files/format_json\zzz_analysis.json
2025-09-03 08:11:33,158 - root - DEBUG - [common.py:105] - === SQL to JSON processing complete for trigger zzz.sql ===
2025-09-03 08:11:33,158 - root - DEBUG - [common.py:105] - âœ“ Created zzz_analysis.json
2025-09-03 08:11:33,158 - root - INFO - [common.py:110] - === File processing complete ===
2025-09-03 08:11:33,158 - root - INFO - [common.py:110] - Successfully processed: 1 files
2025-09-03 08:11:33,159 - root - INFO - [common.py:110] - === Oracle triggers to JSON conversion complete ===
2025-09-03 08:11:33,159 - root - DEBUG - [common.py:105] - Phase 1 complete: Oracle SQL files converted to JSON analysis structure with file metadata
2025-09-03 08:11:33,159 - root - INFO - [common.py:110] - âœ“ JSON conversion complete! (Duration: 1.08 seconds)
2025-09-03 08:11:33,159 - root - DEBUG - [common.py:105] - Step 1 completed in 1.08 seconds
2025-09-03 08:11:33,160 - root - INFO - [common.py:110] - Step 2: Converting JSON analysis back to formatted SQL...
2025-09-03 08:11:33,160 - root - DEBUG - [common.py:105] - Starting Step 2: JSON analysis â†’ formatted Oracle SQL
2025-09-03 08:11:33,160 - root - INFO - [common.py:110] - === Starting JSON analysis to formatted Oracle SQL conversion ===
2025-09-03 08:11:33,160 - root - INFO - [common.py:110] - === Starting file processing ===
2025-09-03 08:11:33,161 - root - INFO - [common.py:110] - Source directory: 'files/format_json'
2025-09-03 08:11:33,161 - root - INFO - [common.py:110] - Target directory: 'files/format_sql'
2025-09-03 08:11:33,161 - root - INFO - [common.py:110] - File pattern: '_analysis.json'
2025-09-03 08:11:33,161 - root - INFO - [common.py:110] - Output suffix: '.sql'
2025-09-03 08:11:33,162 - root - DEBUG - [common.py:105] - Ensuring target directory exists...
2025-09-03 08:11:33,162 - root - DEBUG - [common.py:105] - Directory already exists: files/format_sql
2025-09-03 08:11:33,162 - root - DEBUG - [common.py:105] - Found 1 files in source directory
2025-09-03 08:11:33,162 - root - DEBUG - [common.py:105] - Files matching pattern '_analysis.json': ['zzz_analysis.json']
2025-09-03 08:11:33,162 - root - DEBUG - [common.py:105] - === Processing file 1/1: zzz_analysis.json ===
2025-09-03 08:11:33,162 - root - DEBUG - [common.py:105] - Source path: files/format_json\zzz_analysis.json
2025-09-03 08:11:33,162 - root - DEBUG - [common.py:105] - Output path: files/format_sql\zzz_analysis.sql
2025-09-03 08:11:33,163 - root - DEBUG - [common.py:105] - === JSON to SQL processing for trigger zzz_analysis.json ===
2025-09-03 08:11:33,163 - root - DEBUG - [common.py:105] - Reading JSON analysis file: files/format_json\zzz_analysis.json
2025-09-03 08:11:33,163 - root - DEBUG - [main.py:364] - Successfully loaded analysis JSON with keys: ['declarations', 'main', 'sql_comments', 'rest_string_list', 'conversion_stats', 'metadata']
2025-09-03 08:11:33,163 - root - DEBUG - [common.py:105] - Validating JSON structure...
2025-09-03 08:11:33,163 - root - DEBUG - [common.py:105] - JSON contains 33 total statements
2025-09-03 08:11:33,164 - root - DEBUG - [common.py:105] - JSON validation passed
2025-09-03 08:11:33,164 - root - DEBUG - [common.py:105] - Creating FormatSQL instance...
2025-09-03 08:11:33,164 - root - DEBUG - [common.py:105] - Loading function_mappings from Excel file: utilities/oracle_postgresql_mappings.xlsx
2025-09-03 08:11:33,191 - root - DEBUG - [common.py:105] - Loaded 116 function_mappings mappings from Excel
2025-09-03 08:11:33,191 - root - DEBUG - [common.py:105] - Loading data_type_mappings from Excel file: utilities/oracle_postgresql_mappings.xlsx
2025-09-03 08:11:33,205 - root - DEBUG - [common.py:105] - Loaded 42 data_type_mappings mappings from Excel
2025-09-03 08:11:33,205 - utilities.FormatSQL - DEBUG - [FormatSQL.py:116] - FORMATOracleTriggerAnalyzer initialized successfully
2025-09-03 08:11:33,206 - root - DEBUG - [common.py:105] - FormatSQL created successfully
2025-09-03 08:11:33,206 - root - DEBUG - [common.py:105] - Rendering SQL from analysis...
2025-09-03 08:11:33,206 - utilities.FormatSQL - DEBUG - [FormatSQL.py:274] - SQL generation: Converting JSON analysis to formatted Oracle SQL
2025-09-03 08:11:33,206 - root - DEBUG - [common.py:105] - Analysis contains 4 variables, 0 constants, 7 exceptions
2025-09-03 08:11:33,206 - root - DEBUG - [common.py:105] - Adding header comments with timestamp for Oracle
2025-09-03 08:11:33,206 - root - DEBUG - [common.py:105] - Starting declarations section rendering
2025-09-03 08:11:33,206 - utilities.FormatSQL - DEBUG - [FormatSQL.py:342] - === Rendering Oracle declarations ===
2025-09-03 08:11:33,206 - utilities.FormatSQL - DEBUG - [FormatSQL.py:352] - Rendering 4 variables
2025-09-03 08:11:33,206 - utilities.FormatSQL - DEBUG - [FormatSQL.py:380] - Rendering 7 exceptions
2025-09-03 08:11:33,206 - utilities.FormatSQL - DEBUG - [FormatSQL.py:392] - === Oracle declarations complete ===
2025-09-03 08:11:33,206 - root - DEBUG - [common.py:105] - Generated 12 lines of declarations
2025-09-03 08:11:33,206 - root - DEBUG - [common.py:105] - Declarations rendering took 0.000s
2025-09-03 08:11:33,207 - root - DEBUG - [common.py:105] - Starting main execution block rendering
2025-09-03 08:11:33,207 - utilities.FormatSQL - DEBUG - [FormatSQL.py:411] - === Rendering main block for Oracle ===
2025-09-03 08:11:33,207 - utilities.FormatSQL - DEBUG - [FormatSQL.py:451] - Processing 1 statements in main block
2025-09-03 08:11:33,207 - utilities.FormatSQL - DEBUG - [FormatSQL.py:452] - begin_end_statements statements: 1
2025-09-03 08:11:33,207 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ' (INSERTING OR UPDATING) ', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [{'type': 'elif_statement', 'elif_line_no': 175, 'elif_indent': 4, 'condition': '(DELETING)', 'then_line_no': 175, 'then_statements': [{'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}]}], 'else_statements': []}
2025-09-03 08:11:33,207 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,207 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}
2025-09-03 08:11:33,207 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: with_statement
2025-09-03 08:11:33,207 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,208 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,208 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}
2025-09-03 08:11:33,208 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: raise_statement
2025-09-03 08:11:33,208 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,208 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,208 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}
2025-09-03 08:11:33,208 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: begin_end
2025-09-03 08:11:33,208 - utilities.FormatSQL - DEBUG - [FormatSQL.py:411] - === Rendering main block for Oracle ===
2025-09-03 08:11:33,208 - utilities.FormatSQL - DEBUG - [FormatSQL.py:451] - Processing 1 statements in main block
2025-09-03 08:11:33,208 - utilities.FormatSQL - DEBUG - [FormatSQL.py:452] - begin_end_statements statements: 1
2025-09-03 08:11:33,209 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}
2025-09-03 08:11:33,209 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: merge_statement
2025-09-03 08:11:33,209 - utilities.FormatSQL - DEBUG - [FormatSQL.py:460] - Processing 1 exception handlers
2025-09-03 08:11:33,209 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,209 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,209 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}
2025-09-03 08:11:33,210 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: raise_statement
2025-09-03 08:11:33,210 - root - DEBUG - [common.py:105] - Deep nesting detected (level 6): 'RAISE ERR_INS;...'
2025-09-03 08:11:33,210 - utilities.FormatSQL - DEBUG - [FormatSQL.py:472] - === Main block complete for Oracle ===
2025-09-03 08:11:33,210 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,210 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,210 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}
2025-09-03 08:11:33,210 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,210 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,211 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,211 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}
2025-09-03 08:11:33,211 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: raise_statement
2025-09-03 08:11:33,211 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}
2025-09-03 08:11:33,211 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: delete_statement
2025-09-03 08:11:33,211 - utilities.FormatSQL - DEBUG - [FormatSQL.py:460] - Processing 8 exception handlers
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,212 - utilities.FormatSQL - DEBUG - [FormatSQL.py:472] - === Main block complete for Oracle ===
2025-09-03 08:11:33,213 - root - DEBUG - [common.py:105] - Generated 43 lines in main execution block
2025-09-03 08:11:33,213 - root - DEBUG - [common.py:105] - Main block rendering took 0.006s
2025-09-03 08:11:33,213 - root - DEBUG - [common.py:105] - Adding footer comments
2025-09-03 08:11:33,213 - root - DEBUG - [common.py:105] - Final SQL contains 55 lines, 3496 characters
2025-09-03 08:11:33,213 - root - DEBUG - [common.py:105] - Oracle SQL generation: 55 lines generated in 0.007s
2025-09-03 08:11:33,213 - root - DEBUG - [common.py:105] - SQL rendering completed successfully
2025-09-03 08:11:33,213 - root - DEBUG - [common.py:105] - Rendered SQL length: 3496 characters
2025-09-03 08:11:33,213 - root - DEBUG - [common.py:105] - SQL rendering took: 0.008 seconds
2025-09-03 08:11:33,214 - root - DEBUG - [common.py:105] - Writing formatted SQL to: files/format_sql\zzz_analysis.sql
2025-09-03 08:11:33,214 - root - DEBUG - [common.py:105] - Successfully wrote formatted SQL to files/format_sql\zzz_analysis.sql
2025-09-03 08:11:33,214 - root - DEBUG - [common.py:105] - === JSON to SQL processing complete for trigger zzz_analysis.json ===
2025-09-03 08:11:33,214 - root - DEBUG - [common.py:105] - âœ“ Created zzz_analysis.sql
2025-09-03 08:11:33,214 - root - INFO - [common.py:110] - === File processing complete ===
2025-09-03 08:11:33,215 - root - INFO - [common.py:110] - Successfully processed: 1 files
2025-09-03 08:11:33,215 - root - INFO - [common.py:110] - === Starting comparison with original files ===
2025-09-03 08:11:33,216 - root - DEBUG - [common.py:105] - Comparison complete for zzz.sql: 221 original, 55 generated lines
2025-09-03 08:11:33,216 - root - INFO - [common.py:110] - === Conversion Statistics ===
2025-09-03 08:11:33,216 - root - INFO - [common.py:110] - Total files processed: 1
2025-09-03 08:11:33,216 - root - INFO - [common.py:110] - Successful conversions: 0
2025-09-03 08:11:33,216 - root - INFO - [common.py:110] - Failed conversions: 0
2025-09-03 08:11:33,217 - root - INFO - [common.py:110] - Files with validation warnings: 1
2025-09-03 08:11:33,217 - root - INFO - [common.py:110] - === Comparison Results ===
2025-09-03 08:11:33,217 - root - WARNING - [common.py:115] - File zzz.sql: Significant line count difference: 72.9%
2025-09-03 08:11:33,217 - root - INFO - [common.py:110] - === JSON analysis to formatted Oracle SQL conversion complete ===
2025-09-03 08:11:33,218 - root - INFO - [common.py:110] - âœ“ SQL formatting complete! (Duration: 0.06 seconds)
2025-09-03 08:11:33,218 - root - DEBUG - [common.py:105] - Step 2 completed in 0.06 seconds
2025-09-03 08:11:33,218 - root - INFO - [common.py:110] - Step 5: Converting JSON to PL/JSON...
2025-09-03 08:11:33,218 - root - DEBUG - [common.py:105] - Starting Step 5: JSON â†’ PostgreSQL-compatible PL/JSON
2025-09-03 08:11:33,219 - root - DEBUG - [common.py:105] - processing zzz_analysis.json
2025-09-03 08:11:33,219 - root - DEBUG - [common.py:105] - === Starting to_sql() conversion process ===
2025-09-03 08:11:33,219 - root - DEBUG - [common.py:105] - Creating deep copies of JSON data for each operation type
2025-09-03 08:11:33,226 - root - DEBUG - [common.py:105] - JSON data structure:
2025-09-03 08:11:33,226 - root - DEBUG - [common.py:105] -   - Main blocks: 7 items
2025-09-03 08:11:33,226 - root - DEBUG - [common.py:105] -   - Declarations: 4 variables, 0 constants, 7 exceptions
2025-09-03 08:11:33,226 - root - DEBUG - [common.py:105] - === Processing INSERT operations ===
2025-09-03 08:11:33,226 - root - DEBUG - [common.py:105] - Processing condition for on_insert: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,226 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'INSERTING OR UPDATING'
2025-09-03 08:11:33,226 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,226 - root - DEBUG - [common.py:105] -   - INSERT keywords: True
2025-09-03 08:11:33,226 - root - DEBUG - [common.py:105] -   - UPDATE keywords: True
2025-09-03 08:11:33,226 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,226 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': True, 'on_update': True, 'on_delete': False} on_insert INSERTING OR UPDATING
2025-09-03 08:11:33,227 - root - DEBUG - [common.py:105] - REMOVE: Condition contains on_insert keywords
2025-09-03 08:11:33,227 - root - DEBUG - [common.py:105] - Starting condition modification: ' (INSERTING OR UPDATING) '
2025-09-03 08:11:33,227 - root - DEBUG - [common.py:105] - Stripped condition: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,227 - root - DEBUG - [common.py:105] - Removed keyword 'INSERTING': '(INSERTING OR UPDATING)' â†’ '( OR UPDATING)'
2025-09-03 08:11:33,227 - root - DEBUG - [common.py:105] - Removed keyword 'UPDATING': '( OR UPDATING)' â†’ '( OR )'
2025-09-03 08:11:33,229 - root - DEBUG - [common.py:105] - Final modified condition: '( OR )'
2025-09-03 08:11:33,229 - root - DEBUG - [common.py:105] - Processing condition for on_insert: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,229 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,229 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,229 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,229 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,229 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_insert V_CHK_DISTINCT > 0
2025-09-03 08:11:33,229 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,229 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_DISTINCT > 0 '
2025-09-03 08:11:33,229 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,230 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,230 - root - DEBUG - [common.py:105] - Processing condition for on_insert: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,230 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,230 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,230 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,230 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,230 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_insert V_CHK_IS_MULTIVALUE <= 1
2025-09-03 08:11:33,231 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,231 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_IS_MULTIVALUE <= 1 '
2025-09-03 08:11:33,231 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,231 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,231 - root - DEBUG - [common.py:105] - Processing condition for on_insert: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,231 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,231 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,232 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,232 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,232 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_insert SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0
2025-09-03 08:11:33,232 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,232 - root - DEBUG - [common.py:105] - Starting condition modification: ' SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0 '
2025-09-03 08:11:33,232 - root - DEBUG - [common.py:105] - Stripped condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,232 - root - DEBUG - [common.py:105] - Final modified condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,232 - root - DEBUG - [common.py:105] - Processing condition for on_insert: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,233 - root - DEBUG - [common.py:105] - Removed outer parentheses: ':NEW.GRANTED != :OLD.GRANTED'
2025-09-03 08:11:33,233 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,233 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,233 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,233 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,233 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_insert :NEW.GRANTED != :OLD.GRANTED
2025-09-03 08:11:33,233 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,233 - root - DEBUG - [common.py:105] - Starting condition modification: ' (:NEW.GRANTED != :OLD.GRANTED) '
2025-09-03 08:11:33,233 - root - DEBUG - [common.py:105] - Stripped condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,234 - root - DEBUG - [common.py:105] - Final modified condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,234 - root - DEBUG - [common.py:105] - Processing condition for on_insert: '(DELETING)'
2025-09-03 08:11:33,234 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'DELETING'
2025-09-03 08:11:33,234 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,234 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,234 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,234 - root - DEBUG - [common.py:105] -   - DELETE keywords: True
2025-09-03 08:11:33,234 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': True} on_insert DELETING
2025-09-03 08:11:33,234 - root - DEBUG - [common.py:105] - KEEP: Condition mentions other operations but not on_insert
2025-09-03 08:11:33,234 - root - DEBUG - [common.py:105] - Starting condition modification: '(DELETING)'
2025-09-03 08:11:33,235 - root - DEBUG - [common.py:105] - Stripped condition: '(DELETING)'
2025-09-03 08:11:33,235 - root - DEBUG - [common.py:105] - Removed keyword 'DELETING': '(DELETING)' â†’ '()'
2025-09-03 08:11:33,235 - root - DEBUG - [common.py:105] - Cleaned up parentheses: '()' â†’ ''
2025-09-03 08:11:33,235 - root - DEBUG - [common.py:105] - Condition is empty after processing, returning 'TRUE'
2025-09-03 08:11:33,235 - root - DEBUG - [common.py:105] - === Processing UPDATE operations ===
2025-09-03 08:11:33,235 - root - DEBUG - [common.py:105] - Processing condition for on_update: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,235 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'INSERTING OR UPDATING'
2025-09-03 08:11:33,235 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,235 - root - DEBUG - [common.py:105] -   - INSERT keywords: True
2025-09-03 08:11:33,235 - root - DEBUG - [common.py:105] -   - UPDATE keywords: True
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,236 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': True, 'on_update': True, 'on_delete': False} on_update INSERTING OR UPDATING
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] - REMOVE: Condition contains on_update keywords
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] - Starting condition modification: ' (INSERTING OR UPDATING) '
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] - Stripped condition: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] - Removed keyword 'INSERTING': '(INSERTING OR UPDATING)' â†’ '( OR UPDATING)'
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] - Removed keyword 'UPDATING': '( OR UPDATING)' â†’ '( OR )'
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] - Final modified condition: '( OR )'
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] - Processing condition for on_update: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,236 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,237 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_update V_CHK_DISTINCT > 0
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_DISTINCT > 0 '
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - Processing condition for on_update: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,237 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_update V_CHK_IS_MULTIVALUE <= 1
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_IS_MULTIVALUE <= 1 '
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - Processing condition for on_update: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,237 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,238 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_update SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] - Starting condition modification: ' SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0 '
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] - Stripped condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] - Final modified condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] - Processing condition for on_update: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] - Removed outer parentheses: ':NEW.GRANTED != :OLD.GRANTED'
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,238 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,238 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_update :NEW.GRANTED != :OLD.GRANTED
2025-09-03 08:11:33,239 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,239 - root - DEBUG - [common.py:105] - Starting condition modification: ' (:NEW.GRANTED != :OLD.GRANTED) '
2025-09-03 08:11:33,239 - root - DEBUG - [common.py:105] - Stripped condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,239 - root - DEBUG - [common.py:105] - Final modified condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,239 - root - DEBUG - [common.py:105] - Processing condition for on_update: '(DELETING)'
2025-09-03 08:11:33,239 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'DELETING'
2025-09-03 08:11:33,239 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,240 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,240 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,240 - root - DEBUG - [common.py:105] -   - DELETE keywords: True
2025-09-03 08:11:33,240 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': True} on_update DELETING
2025-09-03 08:11:33,240 - root - DEBUG - [common.py:105] - KEEP: Condition mentions other operations but not on_update
2025-09-03 08:11:33,240 - root - DEBUG - [common.py:105] - Starting condition modification: '(DELETING)'
2025-09-03 08:11:33,240 - root - DEBUG - [common.py:105] - Stripped condition: '(DELETING)'
2025-09-03 08:11:33,240 - root - DEBUG - [common.py:105] - Removed keyword 'DELETING': '(DELETING)' â†’ '()'
2025-09-03 08:11:33,240 - root - DEBUG - [common.py:105] - Cleaned up parentheses: '()' â†’ ''
2025-09-03 08:11:33,240 - root - DEBUG - [common.py:105] - Condition is empty after processing, returning 'TRUE'
2025-09-03 08:11:33,241 - root - DEBUG - [common.py:105] - === Processing DELETE operations ===
2025-09-03 08:11:33,241 - root - DEBUG - [common.py:105] - Processing condition for on_delete: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,241 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'INSERTING OR UPDATING'
2025-09-03 08:11:33,241 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,241 - root - DEBUG - [common.py:105] -   - INSERT keywords: True
2025-09-03 08:11:33,241 - root - DEBUG - [common.py:105] -   - UPDATE keywords: True
2025-09-03 08:11:33,241 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,241 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': True, 'on_update': True, 'on_delete': False} on_delete INSERTING OR UPDATING
2025-09-03 08:11:33,242 - root - DEBUG - [common.py:105] - KEEP: Condition mentions other operations but not on_delete
2025-09-03 08:11:33,242 - root - DEBUG - [common.py:105] - Starting condition modification: ' (INSERTING OR UPDATING) '
2025-09-03 08:11:33,242 - root - DEBUG - [common.py:105] - Stripped condition: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,242 - root - DEBUG - [common.py:105] - Removed keyword 'INSERTING': '(INSERTING OR UPDATING)' â†’ '( OR UPDATING)'
2025-09-03 08:11:33,242 - root - DEBUG - [common.py:105] - Removed keyword 'UPDATING': '( OR UPDATING)' â†’ '( OR )'
2025-09-03 08:11:33,242 - root - DEBUG - [common.py:105] - Final modified condition: '( OR )'
2025-09-03 08:11:33,242 - root - DEBUG - [common.py:105] - Processing condition for on_delete: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,242 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,243 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_delete V_CHK_DISTINCT > 0
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_DISTINCT > 0 '
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] - Processing condition for on_delete: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,243 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_delete V_CHK_IS_MULTIVALUE <= 1
2025-09-03 08:11:33,243 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,244 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_IS_MULTIVALUE <= 1 '
2025-09-03 08:11:33,244 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,244 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,244 - root - DEBUG - [common.py:105] - Processing condition for on_delete: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,244 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,244 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,244 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,244 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,244 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_delete SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0
2025-09-03 08:11:33,244 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,244 - root - DEBUG - [common.py:105] - Starting condition modification: ' SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0 '
2025-09-03 08:11:33,244 - root - DEBUG - [common.py:105] - Stripped condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] - Final modified condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] - Processing condition for on_delete: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] - Removed outer parentheses: ':NEW.GRANTED != :OLD.GRANTED'
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,245 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_delete :NEW.GRANTED != :OLD.GRANTED
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] - Starting condition modification: ' (:NEW.GRANTED != :OLD.GRANTED) '
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] - Stripped condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] - Final modified condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] - Processing condition for on_delete: '(DELETING)'
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'DELETING'
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,245 - root - DEBUG - [common.py:105] -   - DELETE keywords: True
2025-09-03 08:11:33,245 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': True} on_delete DELETING
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - REMOVE: Condition contains on_delete keywords
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Starting condition modification: '(DELETING)'
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Stripped condition: '(DELETING)'
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Removed keyword 'DELETING': '(DELETING)' â†’ '()'
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Cleaned up parentheses: '()' â†’ ''
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Condition is empty after processing, returning 'TRUE'
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Processing condition for on_delete: ':OLD.HOLIDAY_DATE IS NULL'
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,246 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_delete :OLD.HOLIDAY_DATE IS NULL
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Starting condition modification: ' :OLD.HOLIDAY_DATE IS NULL '
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Stripped condition: ':OLD.HOLIDAY_DATE IS NULL'
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Final modified condition: ':OLD.HOLIDAY_DATE IS NULL'
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Starting condition modification: 'TRUE'
2025-09-03 08:11:33,246 - root - DEBUG - [common.py:105] - Stripped condition: 'TRUE'
2025-09-03 08:11:33,247 - root - DEBUG - [common.py:105] - Final modified condition: 'TRUE'
2025-09-03 08:11:33,247 - root - DEBUG - [common.py:105] - Building final converted structure
2025-09-03 08:11:33,247 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'begin_end', 'begin_line_no': 15, 'begin_indent': 0, 'begin_end_statements': [{'condition': '( OR )', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [], 'else_statements': []}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}], 'exception_line_no': 183, 'end_line_no': 218}
2025-09-03 08:11:33,247 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': '( OR )', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,247 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}
2025-09-03 08:11:33,247 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,247 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}
2025-09-03 08:11:33,247 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,247 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,248 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,249 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,249 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,249 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,249 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,249 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,249 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,249 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,249 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,250 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'begin_end', 'begin_line_no': 15, 'begin_indent': 0, 'begin_end_statements': [{'condition': '( OR )', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [], 'else_statements': []}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}], 'exception_line_no': 183, 'end_line_no': 218}
2025-09-03 08:11:33,250 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': '( OR )', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,250 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}
2025-09-03 08:11:33,250 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,250 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}
2025-09-03 08:11:33,250 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,250 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}
2025-09-03 08:11:33,251 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}
2025-09-03 08:11:33,251 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}
2025-09-03 08:11:33,251 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,251 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}
2025-09-03 08:11:33,251 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,251 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}
2025-09-03 08:11:33,251 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,251 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,251 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,251 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'begin_end', 'begin_line_no': 15, 'begin_indent': 0, 'begin_end_statements': [{'condition': 'TRUE', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'condition': ':OLD.HOLIDAY_DATE IS NULL', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}], 'if_elses': [], 'else_statements': []}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}], 'exception_line_no': 183, 'end_line_no': 218}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'TRUE', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'condition': ':OLD.HOLIDAY_DATE IS NULL', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,252 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': ':OLD.HOLIDAY_DATE IS NULL', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,253 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}
2025-09-03 08:11:33,253 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}
2025-09-03 08:11:33,253 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,253 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,253 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,253 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,253 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,253 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,253 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,253 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,254 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,254 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,254 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,254 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,254 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,254 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,254 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,254 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,254 - root - DEBUG - [common.py:105] - Converting to JSON string
2025-09-03 08:11:33,255 - root - DEBUG - [common.py:105] - Generated JSON string with 36761 characters
2025-09-03 08:11:33,256 - root - DEBUG - [common.py:105] - === to_sql() conversion complete ===
2025-09-03 08:11:33,256 - root - DEBUG - [common.py:105] - === Starting to_sql() conversion process ===
2025-09-03 08:11:33,256 - root - DEBUG - [common.py:105] - Creating deep copies of JSON data for each operation type
2025-09-03 08:11:33,257 - root - DEBUG - [common.py:105] - JSON data structure:
2025-09-03 08:11:33,257 - root - DEBUG - [common.py:105] -   - Main blocks: 7 items
2025-09-03 08:11:33,257 - root - DEBUG - [common.py:105] -   - Declarations: 4 variables, 0 constants, 7 exceptions
2025-09-03 08:11:33,257 - root - DEBUG - [common.py:105] - === Processing INSERT operations ===
2025-09-03 08:11:33,257 - root - DEBUG - [common.py:105] - Processing condition for on_insert: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,257 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'INSERTING OR UPDATING'
2025-09-03 08:11:33,257 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] -   - INSERT keywords: True
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] -   - UPDATE keywords: True
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,258 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': True, 'on_update': True, 'on_delete': False} on_insert INSERTING OR UPDATING
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - REMOVE: Condition contains on_insert keywords
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - Starting condition modification: ' (INSERTING OR UPDATING) '
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - Stripped condition: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - Removed keyword 'INSERTING': '(INSERTING OR UPDATING)' â†’ '( OR UPDATING)'
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - Removed keyword 'UPDATING': '( OR UPDATING)' â†’ '( OR )'
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - Final modified condition: '( OR )'
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - Processing condition for on_insert: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,258 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_insert V_CHK_DISTINCT > 0
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_DISTINCT > 0 '
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,258 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,259 - root - DEBUG - [common.py:105] - Processing condition for on_insert: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,259 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,259 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,259 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,259 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,259 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_insert V_CHK_IS_MULTIVALUE <= 1
2025-09-03 08:11:33,259 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,259 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_IS_MULTIVALUE <= 1 '
2025-09-03 08:11:33,259 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,260 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,261 - root - DEBUG - [common.py:105] - Processing condition for on_insert: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,262 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,262 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,262 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,262 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,264 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_insert SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0
2025-09-03 08:11:33,264 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,264 - root - DEBUG - [common.py:105] - Starting condition modification: ' SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0 '
2025-09-03 08:11:33,264 - root - DEBUG - [common.py:105] - Stripped condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,264 - root - DEBUG - [common.py:105] - Final modified condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,264 - root - DEBUG - [common.py:105] - Processing condition for on_insert: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,264 - root - DEBUG - [common.py:105] - Removed outer parentheses: ':NEW.GRANTED != :OLD.GRANTED'
2025-09-03 08:11:33,264 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,265 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,265 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,265 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,265 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_insert :NEW.GRANTED != :OLD.GRANTED
2025-09-03 08:11:33,265 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,265 - root - DEBUG - [common.py:105] - Starting condition modification: ' (:NEW.GRANTED != :OLD.GRANTED) '
2025-09-03 08:11:33,265 - root - DEBUG - [common.py:105] - Stripped condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,265 - root - DEBUG - [common.py:105] - Final modified condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,265 - root - DEBUG - [common.py:105] - Processing condition for on_insert: '(DELETING)'
2025-09-03 08:11:33,266 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'DELETING'
2025-09-03 08:11:33,266 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,266 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,266 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,266 - root - DEBUG - [common.py:105] -   - DELETE keywords: True
2025-09-03 08:11:33,266 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': True} on_insert DELETING
2025-09-03 08:11:33,266 - root - DEBUG - [common.py:105] - KEEP: Condition mentions other operations but not on_insert
2025-09-03 08:11:33,266 - root - DEBUG - [common.py:105] - Starting condition modification: '(DELETING)'
2025-09-03 08:11:33,266 - root - DEBUG - [common.py:105] - Stripped condition: '(DELETING)'
2025-09-03 08:11:33,266 - root - DEBUG - [common.py:105] - Removed keyword 'DELETING': '(DELETING)' â†’ '()'
2025-09-03 08:11:33,267 - root - DEBUG - [common.py:105] - Cleaned up parentheses: '()' â†’ ''
2025-09-03 08:11:33,267 - root - DEBUG - [common.py:105] - Condition is empty after processing, returning 'TRUE'
2025-09-03 08:11:33,267 - root - DEBUG - [common.py:105] - === Processing UPDATE operations ===
2025-09-03 08:11:33,267 - root - DEBUG - [common.py:105] - Processing condition for on_update: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,267 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'INSERTING OR UPDATING'
2025-09-03 08:11:33,267 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,267 - root - DEBUG - [common.py:105] -   - INSERT keywords: True
2025-09-03 08:11:33,267 - root - DEBUG - [common.py:105] -   - UPDATE keywords: True
2025-09-03 08:11:33,267 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,267 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': True, 'on_update': True, 'on_delete': False} on_update INSERTING OR UPDATING
2025-09-03 08:11:33,267 - root - DEBUG - [common.py:105] - REMOVE: Condition contains on_update keywords
2025-09-03 08:11:33,268 - root - DEBUG - [common.py:105] - Starting condition modification: ' (INSERTING OR UPDATING) '
2025-09-03 08:11:33,268 - root - DEBUG - [common.py:105] - Stripped condition: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,268 - root - DEBUG - [common.py:105] - Removed keyword 'INSERTING': '(INSERTING OR UPDATING)' â†’ '( OR UPDATING)'
2025-09-03 08:11:33,268 - root - DEBUG - [common.py:105] - Removed keyword 'UPDATING': '( OR UPDATING)' â†’ '( OR )'
2025-09-03 08:11:33,268 - root - DEBUG - [common.py:105] - Final modified condition: '( OR )'
2025-09-03 08:11:33,268 - root - DEBUG - [common.py:105] - Processing condition for on_update: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,268 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,268 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,268 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,268 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,268 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_update V_CHK_DISTINCT > 0
2025-09-03 08:11:33,268 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,269 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_DISTINCT > 0 '
2025-09-03 08:11:33,269 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,269 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,269 - root - DEBUG - [common.py:105] - Processing condition for on_update: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,269 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,269 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,270 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,270 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,270 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_update V_CHK_IS_MULTIVALUE <= 1
2025-09-03 08:11:33,270 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,270 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_IS_MULTIVALUE <= 1 '
2025-09-03 08:11:33,270 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,270 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,271 - root - DEBUG - [common.py:105] - Processing condition for on_update: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,271 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,271 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,271 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,271 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,271 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_update SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0
2025-09-03 08:11:33,271 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,271 - root - DEBUG - [common.py:105] - Starting condition modification: ' SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0 '
2025-09-03 08:11:33,271 - root - DEBUG - [common.py:105] - Stripped condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,271 - root - DEBUG - [common.py:105] - Final modified condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,272 - root - DEBUG - [common.py:105] - Processing condition for on_update: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,272 - root - DEBUG - [common.py:105] - Removed outer parentheses: ':NEW.GRANTED != :OLD.GRANTED'
2025-09-03 08:11:33,272 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,272 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,272 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,272 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,272 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_update :NEW.GRANTED != :OLD.GRANTED
2025-09-03 08:11:33,272 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,272 - root - DEBUG - [common.py:105] - Starting condition modification: ' (:NEW.GRANTED != :OLD.GRANTED) '
2025-09-03 08:11:33,272 - root - DEBUG - [common.py:105] - Stripped condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,273 - root - DEBUG - [common.py:105] - Final modified condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,273 - root - DEBUG - [common.py:105] - Processing condition for on_update: '(DELETING)'
2025-09-03 08:11:33,273 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'DELETING'
2025-09-03 08:11:33,273 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,273 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,273 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,273 - root - DEBUG - [common.py:105] -   - DELETE keywords: True
2025-09-03 08:11:33,273 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': True} on_update DELETING
2025-09-03 08:11:33,273 - root - DEBUG - [common.py:105] - KEEP: Condition mentions other operations but not on_update
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - Starting condition modification: '(DELETING)'
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - Stripped condition: '(DELETING)'
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - Removed keyword 'DELETING': '(DELETING)' â†’ '()'
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - Cleaned up parentheses: '()' â†’ ''
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - Condition is empty after processing, returning 'TRUE'
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - === Processing DELETE operations ===
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - Processing condition for on_delete: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'INSERTING OR UPDATING'
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] -   - INSERT keywords: True
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] -   - UPDATE keywords: True
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,274 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': True, 'on_update': True, 'on_delete': False} on_delete INSERTING OR UPDATING
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - KEEP: Condition mentions other operations but not on_delete
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - Starting condition modification: ' (INSERTING OR UPDATING) '
2025-09-03 08:11:33,274 - root - DEBUG - [common.py:105] - Stripped condition: '(INSERTING OR UPDATING)'
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - Removed keyword 'INSERTING': '(INSERTING OR UPDATING)' â†’ '( OR UPDATING)'
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - Removed keyword 'UPDATING': '( OR UPDATING)' â†’ '( OR )'
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - Final modified condition: '( OR )'
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - Processing condition for on_delete: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,275 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_delete V_CHK_DISTINCT > 0
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_DISTINCT > 0 '
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_DISTINCT > 0'
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - Processing condition for on_delete: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,275 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_delete V_CHK_IS_MULTIVALUE <= 1
2025-09-03 08:11:33,275 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - Starting condition modification: ' V_CHK_IS_MULTIVALUE <= 1 '
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - Stripped condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - Final modified condition: 'V_CHK_IS_MULTIVALUE <= 1'
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - Processing condition for on_delete: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,276 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_delete SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - Starting condition modification: ' SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0 '
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - Stripped condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - Final modified condition: 'SQLCODE = -1407 AND INSTR(SQLERRM, '"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"') > 0'
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - Processing condition for on_delete: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - Removed outer parentheses: ':NEW.GRANTED != :OLD.GRANTED'
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,276 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,276 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_delete :NEW.GRANTED != :OLD.GRANTED
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Starting condition modification: ' (:NEW.GRANTED != :OLD.GRANTED) '
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Stripped condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Final modified condition: '(:NEW.GRANTED != :OLD.GRANTED)'
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Processing condition for on_delete: '(DELETING)'
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Removed outer parentheses: 'DELETING'
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] -   - DELETE keywords: True
2025-09-03 08:11:33,277 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': True} on_delete DELETING
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - REMOVE: Condition contains on_delete keywords
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Starting condition modification: '(DELETING)'
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Stripped condition: '(DELETING)'
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Removed keyword 'DELETING': '(DELETING)' â†’ '()'
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Cleaned up parentheses: '()' â†’ ''
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Condition is empty after processing, returning 'TRUE'
2025-09-03 08:11:33,277 - root - DEBUG - [common.py:105] - Processing condition for on_delete: ':OLD.HOLIDAY_DATE IS NULL'
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] - Operation keywords found in condition:
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] -   - INSERT keywords: False
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] -   - UPDATE keywords: False
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] -   - DELETE keywords: False
2025-09-03 08:11:33,278 - root - DEBUG - [JSONTOPLJSON.py:184] - condition_dict: {'on_insert': False, 'on_update': False, 'on_delete': False} on_delete :OLD.HOLIDAY_DATE IS NULL
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] - KEEP: Condition doesn't contain any operation keywords
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] - Starting condition modification: ' :OLD.HOLIDAY_DATE IS NULL '
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] - Stripped condition: ':OLD.HOLIDAY_DATE IS NULL'
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] - Final modified condition: ':OLD.HOLIDAY_DATE IS NULL'
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] - Starting condition modification: 'TRUE'
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] - Stripped condition: 'TRUE'
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] - Final modified condition: 'TRUE'
2025-09-03 08:11:33,278 - root - DEBUG - [common.py:105] - Building final converted structure
2025-09-03 08:11:33,278 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'begin_end', 'begin_line_no': 15, 'begin_indent': 0, 'begin_end_statements': [{'condition': '( OR )', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [], 'else_statements': []}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}], 'exception_line_no': 183, 'end_line_no': 218}
2025-09-03 08:11:33,279 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': '( OR )', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,279 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}
2025-09-03 08:11:33,279 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,279 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}
2025-09-03 08:11:33,279 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,279 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}
2025-09-03 08:11:33,279 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}
2025-09-03 08:11:33,280 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}
2025-09-03 08:11:33,280 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,280 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}
2025-09-03 08:11:33,280 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,280 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}
2025-09-03 08:11:33,280 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,280 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,280 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,281 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,282 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,282 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'begin_end', 'begin_line_no': 15, 'begin_indent': 0, 'begin_end_statements': [{'condition': '( OR )', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [], 'else_statements': []}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}], 'exception_line_no': 183, 'end_line_no': 218}
2025-09-03 08:11:33,282 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': '( OR )', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,282 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}
2025-09-03 08:11:33,282 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,283 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'begin_end', 'begin_line_no': 15, 'begin_indent': 0, 'begin_end_statements': [{'condition': 'TRUE', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'condition': ':OLD.HOLIDAY_DATE IS NULL', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}], 'if_elses': [], 'else_statements': []}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}, {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}], 'exception_line_no': 183, 'end_line_no': 218}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': 'TRUE', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'condition': ':OLD.HOLIDAY_DATE IS NULL', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'condition': ':OLD.HOLIDAY_DATE IS NULL', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'DUP_VAL_ON_INDEX', 'when_line_no': 186, 'when_indent': 4, 'then_line_no': 186, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,284 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20101', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20101, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_INS', 'when_line_no': 190, 'when_indent': 4, 'then_line_no': 190, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20102', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20102, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD', 'when_line_no': 194, 'when_indent': 4, 'then_line_no': 194, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20103', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20103, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD2', 'when_line_no': 198, 'when_indent': 4, 'then_line_no': 198, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20104', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20104, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD3', 'when_line_no': 202, 'when_indent': 4, 'then_line_no': 202, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20105', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20105, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_UPD4', 'when_line_no': 206, 'when_indent': 4, 'then_line_no': 206, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20106', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20106, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_DEL', 'when_line_no': 210, 'when_indent': 4, 'then_line_no': 210, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20107', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20107, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'exception_handler', 'exception_name': 'ERR_LEVEL', 'when_line_no': 214, 'when_indent': 4, 'then_line_no': 214, 'exception_statements': [{'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}]}
2025-09-03 08:11:33,285 - root - DEBUG - [JSONTOPLJSON.py:330] - statement: {'type': 'function_calling', 'function_name': 'RAISE_APPLICATION_ERROR', 'parameters': {'parameter_type': 'positional', 'positional_params': ['-20108', "'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"], 'named_params': {}, 'raw_text': "-20108, 'MDM_V_PUBLIC_HOLIDAYS_MTN_IOF'"}}
2025-09-03 08:11:33,285 - root - DEBUG - [common.py:105] - Converting to JSON string
2025-09-03 08:11:33,286 - root - DEBUG - [common.py:105] - Generated JSON string with 36761 characters
2025-09-03 08:11:33,286 - root - DEBUG - [common.py:105] - === to_sql() conversion complete ===
2025-09-03 08:11:33,286 - root - DEBUG - [common.py:105] - Created zzz.json
2025-09-03 08:11:33,286 - root - INFO - [common.py:110] - âœ“ PL/JSON conversion complete! (Duration: 0.07 seconds)
2025-09-03 08:11:33,287 - root - DEBUG - [common.py:105] - Step 5 completed in 0.07 seconds
2025-09-03 08:11:33,287 - root - INFO - [common.py:110] - Step 6: Converting PL/JSON to PostgreSQL format...
2025-09-03 08:11:33,287 - root - DEBUG - [common.py:105] - Starting Step 6: PL/JSON â†’ PostgreSQL format JSON
2025-09-03 08:11:33,287 - root - INFO - [common.py:110] - === Starting PL/JSON to PostgreSQL format conversion ===
2025-09-03 08:11:33,287 - root - INFO - [common.py:110] - === Starting file processing ===
2025-09-03 08:11:33,287 - root - INFO - [common.py:110] - Source directory: 'files/format_pl_json'
2025-09-03 08:11:33,288 - root - INFO - [common.py:110] - Target directory: 'files/format_plsql'
2025-09-03 08:11:33,288 - root - INFO - [common.py:110] - File pattern: '.json'
2025-09-03 08:11:33,288 - root - INFO - [common.py:110] - Output suffix: '_postgresql.json'
2025-09-03 08:11:33,288 - root - DEBUG - [common.py:105] - Ensuring target directory exists...
2025-09-03 08:11:33,288 - root - DEBUG - [common.py:105] - Directory already exists: files/format_plsql
2025-09-03 08:11:33,288 - root - DEBUG - [common.py:105] - Found 1 files in source directory
2025-09-03 08:11:33,288 - root - DEBUG - [common.py:105] - Files matching pattern '.json': ['zzz.json']
2025-09-03 08:11:33,288 - root - DEBUG - [common.py:105] - === Processing file 1/1: zzz.json ===
2025-09-03 08:11:33,289 - root - DEBUG - [common.py:105] - Source path: files/format_pl_json\zzz.json
2025-09-03 08:11:33,289 - root - DEBUG - [common.py:105] - Output path: files/format_plsql\zzz_postgresql.json
2025-09-03 08:11:33,289 - root - DEBUG - [common.py:105] - === Converting PL/JSON to PostgreSQL format for trigger zzz.json ===
2025-09-03 08:11:33,289 - root - DEBUG - [common.py:105] - Reading PL/JSON file: files/format_pl_json\zzz.json
2025-09-03 08:11:33,290 - root - DEBUG - [common.py:105] - Successfully loaded PL/JSON data with keys: ['on_insert', 'on_update', 'on_delete', 'metadata']
2025-09-03 08:11:33,290 - root - DEBUG - [common.py:105] - Converting to PostgreSQL format...
2025-09-03 08:11:33,290 - root - DEBUG - [common.py:105] - Converting complex structure to PostgreSQL SQL
2025-09-03 08:11:33,290 - root - DEBUG - [common.py:105] - Loading function_mappings from Excel file: utilities/oracle_postgresql_mappings.xlsx
2025-09-03 08:11:33,311 - root - DEBUG - [common.py:105] - Loaded 116 function_mappings mappings from Excel
2025-09-03 08:11:33,311 - root - DEBUG - [common.py:105] - Loading data_type_mappings from Excel file: utilities/oracle_postgresql_mappings.xlsx
2025-09-03 08:11:33,326 - root - DEBUG - [common.py:105] - Loaded 42 data_type_mappings mappings from Excel
2025-09-03 08:11:33,326 - utilities.FormatSQL - DEBUG - [FormatSQL.py:116] - FORMATOracleTriggerAnalyzer initialized successfully
2025-09-03 08:11:33,326 - utilities.FormatSQL - DEBUG - [FormatSQL.py:274] - SQL generation: Converting JSON analysis to formatted PostgreSQL SQL
2025-09-03 08:11:33,326 - root - DEBUG - [common.py:105] - Analysis contains 4 variables, 0 constants, 7 exceptions
2025-09-03 08:11:33,326 - root - DEBUG - [common.py:105] - Adding header comments with timestamp for PostgreSQL
2025-09-03 08:11:33,326 - root - DEBUG - [common.py:105] - Starting declarations section rendering
2025-09-03 08:11:33,326 - utilities.FormatSQL - DEBUG - [FormatSQL.py:342] - === Rendering PostgreSQL declarations ===
2025-09-03 08:11:33,326 - utilities.FormatSQL - DEBUG - [FormatSQL.py:392] - === PostgreSQL declarations complete ===
2025-09-03 08:11:33,326 - root - DEBUG - [common.py:105] - Generated 0 lines of declarations
2025-09-03 08:11:33,326 - root - DEBUG - [common.py:105] - Declarations rendering took 0.000s
2025-09-03 08:11:33,326 - root - DEBUG - [common.py:105] - Starting main execution block rendering
2025-09-03 08:11:33,326 - utilities.FormatSQL - DEBUG - [FormatSQL.py:411] - === Rendering main block for PostgreSQL ===
2025-09-03 08:11:33,326 - utilities.FormatSQL - DEBUG - [FormatSQL.py:420] - Rendering 4 variables for PostgreSQL
2025-09-03 08:11:33,327 - utilities.FormatSQL - DEBUG - [FormatSQL.py:451] - Processing 1 statements in main block
2025-09-03 08:11:33,327 - utilities.FormatSQL - DEBUG - [FormatSQL.py:452] - begin_end_statements statements: 1
2025-09-03 08:11:33,327 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': '( OR )', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,327 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,334 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}
2025-09-03 08:11:33,334 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: with_statement
2025-09-03 08:11:33,344 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,344 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,345 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}
2025-09-03 08:11:33,345 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: raise_statement
2025-09-03 08:11:33,345 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,345 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,346 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}
2025-09-03 08:11:33,346 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: begin_end
2025-09-03 08:11:33,346 - utilities.FormatSQL - DEBUG - [FormatSQL.py:411] - === Rendering main block for PostgreSQL ===
2025-09-03 08:11:33,346 - utilities.FormatSQL - DEBUG - [FormatSQL.py:451] - Processing 1 statements in main block
2025-09-03 08:11:33,346 - utilities.FormatSQL - DEBUG - [FormatSQL.py:452] - begin_end_statements statements: 1
2025-09-03 08:11:33,346 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}
2025-09-03 08:11:33,346 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: merge_statement
2025-09-03 08:11:33,350 - utilities.FormatSQL - DEBUG - [FormatSQL.py:472] - === Main block complete for PostgreSQL ===
2025-09-03 08:11:33,351 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,351 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,351 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}
2025-09-03 08:11:33,352 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,352 - utilities.FormatSQL - DEBUG - [FormatSQL.py:472] - === Main block complete for PostgreSQL ===
2025-09-03 08:11:33,352 - root - DEBUG - [common.py:105] - Generated 21 lines in main execution block
2025-09-03 08:11:33,352 - root - DEBUG - [common.py:105] - Main block rendering took 0.025s
2025-09-03 08:11:33,352 - root - DEBUG - [common.py:105] - Adding footer comments
2025-09-03 08:11:33,352 - root - DEBUG - [common.py:105] - Final SQL contains 21 lines, 2151 characters
2025-09-03 08:11:33,352 - root - DEBUG - [common.py:105] - PostgreSQL SQL generation: 21 lines generated in 0.026s
2025-09-03 08:11:33,352 - root - DEBUG - [common.py:105] - Successfully converted complex structure to PostgreSQL SQL
2025-09-03 08:11:33,352 - root - DEBUG - [common.py:105] - Converting complex structure to PostgreSQL SQL
2025-09-03 08:11:33,352 - root - DEBUG - [common.py:105] - Loading function_mappings from Excel file: utilities/oracle_postgresql_mappings.xlsx
2025-09-03 08:11:33,367 - root - DEBUG - [common.py:105] - Loaded 116 function_mappings mappings from Excel
2025-09-03 08:11:33,367 - root - DEBUG - [common.py:105] - Loading data_type_mappings from Excel file: utilities/oracle_postgresql_mappings.xlsx
2025-09-03 08:11:33,378 - root - DEBUG - [common.py:105] - Loaded 42 data_type_mappings mappings from Excel
2025-09-03 08:11:33,378 - utilities.FormatSQL - DEBUG - [FormatSQL.py:116] - FORMATOracleTriggerAnalyzer initialized successfully
2025-09-03 08:11:33,378 - utilities.FormatSQL - DEBUG - [FormatSQL.py:274] - SQL generation: Converting JSON analysis to formatted PostgreSQL SQL
2025-09-03 08:11:33,378 - root - DEBUG - [common.py:105] - Analysis contains 4 variables, 0 constants, 7 exceptions
2025-09-03 08:11:33,378 - root - DEBUG - [common.py:105] - Adding header comments with timestamp for PostgreSQL
2025-09-03 08:11:33,378 - root - DEBUG - [common.py:105] - Starting declarations section rendering
2025-09-03 08:11:33,378 - utilities.FormatSQL - DEBUG - [FormatSQL.py:342] - === Rendering PostgreSQL declarations ===
2025-09-03 08:11:33,378 - utilities.FormatSQL - DEBUG - [FormatSQL.py:392] - === PostgreSQL declarations complete ===
2025-09-03 08:11:33,378 - root - DEBUG - [common.py:105] - Generated 0 lines of declarations
2025-09-03 08:11:33,378 - root - DEBUG - [common.py:105] - Declarations rendering took 0.000s
2025-09-03 08:11:33,378 - root - DEBUG - [common.py:105] - Starting main execution block rendering
2025-09-03 08:11:33,378 - utilities.FormatSQL - DEBUG - [FormatSQL.py:411] - === Rendering main block for PostgreSQL ===
2025-09-03 08:11:33,378 - utilities.FormatSQL - DEBUG - [FormatSQL.py:420] - Rendering 4 variables for PostgreSQL
2025-09-03 08:11:33,379 - utilities.FormatSQL - DEBUG - [FormatSQL.py:451] - Processing 1 statements in main block
2025-09-03 08:11:33,379 - utilities.FormatSQL - DEBUG - [FormatSQL.py:452] - begin_end_statements statements: 1
2025-09-03 08:11:33,379 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': '( OR )', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,379 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,380 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}
2025-09-03 08:11:33,381 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: with_statement
2025-09-03 08:11:33,386 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': 'V_CHK_DISTINCT > 0', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,386 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,386 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}
2025-09-03 08:11:33,386 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: raise_statement
2025-09-03 08:11:33,387 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': 'V_CHK_IS_MULTIVALUE <= 1', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,387 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,387 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': 'SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}
2025-09-03 08:11:33,387 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: begin_end
2025-09-03 08:11:33,387 - utilities.FormatSQL - DEBUG - [FormatSQL.py:411] - === Rendering main block for PostgreSQL ===
2025-09-03 08:11:33,387 - utilities.FormatSQL - DEBUG - [FormatSQL.py:451] - Processing 1 statements in main block
2025-09-03 08:11:33,387 - utilities.FormatSQL - DEBUG - [FormatSQL.py:452] - begin_end_statements statements: 1
2025-09-03 08:11:33,387 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}
2025-09-03 08:11:33,387 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: merge_statement
2025-09-03 08:11:33,393 - utilities.FormatSQL - DEBUG - [FormatSQL.py:472] - === Main block complete for PostgreSQL ===
2025-09-03 08:11:33,393 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': '(:NEW.GRANTED != :OLD.GRANTED)', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,393 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,394 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}
2025-09-03 08:11:33,394 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,394 - utilities.FormatSQL - DEBUG - [FormatSQL.py:472] - === Main block complete for PostgreSQL ===
2025-09-03 08:11:33,394 - root - DEBUG - [common.py:105] - Generated 21 lines in main execution block
2025-09-03 08:11:33,394 - root - DEBUG - [common.py:105] - Main block rendering took 0.016s
2025-09-03 08:11:33,394 - root - DEBUG - [common.py:105] - Adding footer comments
2025-09-03 08:11:33,394 - root - DEBUG - [common.py:105] - Final SQL contains 21 lines, 2151 characters
2025-09-03 08:11:33,394 - root - DEBUG - [common.py:105] - PostgreSQL SQL generation: 21 lines generated in 0.016s
2025-09-03 08:11:33,394 - root - DEBUG - [common.py:105] - Successfully converted complex structure to PostgreSQL SQL
2025-09-03 08:11:33,394 - root - DEBUG - [common.py:105] - Converting complex structure to PostgreSQL SQL
2025-09-03 08:11:33,394 - root - DEBUG - [common.py:105] - Loading function_mappings from Excel file: utilities/oracle_postgresql_mappings.xlsx
2025-09-03 08:11:33,413 - root - DEBUG - [common.py:105] - Loaded 116 function_mappings mappings from Excel
2025-09-03 08:11:33,413 - root - DEBUG - [common.py:105] - Loading data_type_mappings from Excel file: utilities/oracle_postgresql_mappings.xlsx
2025-09-03 08:11:33,425 - root - DEBUG - [common.py:105] - Loaded 42 data_type_mappings mappings from Excel
2025-09-03 08:11:33,425 - utilities.FormatSQL - DEBUG - [FormatSQL.py:116] - FORMATOracleTriggerAnalyzer initialized successfully
2025-09-03 08:11:33,425 - utilities.FormatSQL - DEBUG - [FormatSQL.py:274] - SQL generation: Converting JSON analysis to formatted PostgreSQL SQL
2025-09-03 08:11:33,425 - root - DEBUG - [common.py:105] - Analysis contains 4 variables, 0 constants, 7 exceptions
2025-09-03 08:11:33,425 - root - DEBUG - [common.py:105] - Adding header comments with timestamp for PostgreSQL
2025-09-03 08:11:33,425 - root - DEBUG - [common.py:105] - Starting declarations section rendering
2025-09-03 08:11:33,425 - utilities.FormatSQL - DEBUG - [FormatSQL.py:342] - === Rendering PostgreSQL declarations ===
2025-09-03 08:11:33,425 - utilities.FormatSQL - DEBUG - [FormatSQL.py:392] - === PostgreSQL declarations complete ===
2025-09-03 08:11:33,425 - root - DEBUG - [common.py:105] - Generated 0 lines of declarations
2025-09-03 08:11:33,425 - root - DEBUG - [common.py:105] - Declarations rendering took 0.000s
2025-09-03 08:11:33,426 - root - DEBUG - [common.py:105] - Starting main execution block rendering
2025-09-03 08:11:33,426 - utilities.FormatSQL - DEBUG - [FormatSQL.py:411] - === Rendering main block for PostgreSQL ===
2025-09-03 08:11:33,426 - utilities.FormatSQL - DEBUG - [FormatSQL.py:420] - Rendering 4 variables for PostgreSQL
2025-09-03 08:11:33,426 - utilities.FormatSQL - DEBUG - [FormatSQL.py:451] - Processing 1 statements in main block
2025-09-03 08:11:33,426 - utilities.FormatSQL - DEBUG - [FormatSQL.py:452] - begin_end_statements statements: 1
2025-09-03 08:11:33,426 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': 'TRUE', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'condition': ':OLD.HOLIDAY_DATE IS NULL', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,426 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,427 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ':OLD.HOLIDAY_DATE IS NULL', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,427 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,428 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}
2025-09-03 08:11:33,428 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: raise_statement
2025-09-03 08:11:33,428 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}
2025-09-03 08:11:33,428 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: delete_statement
2025-09-03 08:11:33,431 - utilities.FormatSQL - DEBUG - [FormatSQL.py:472] - === Main block complete for PostgreSQL ===
2025-09-03 08:11:33,432 - root - DEBUG - [common.py:105] - Generated 13 lines in main execution block
2025-09-03 08:11:33,432 - root - DEBUG - [common.py:105] - Main block rendering took 0.006s
2025-09-03 08:11:33,432 - root - DEBUG - [common.py:105] - Adding footer comments
2025-09-03 08:11:33,432 - root - DEBUG - [common.py:105] - Final SQL contains 13 lines, 332 characters
2025-09-03 08:11:33,432 - root - DEBUG - [common.py:105] - PostgreSQL SQL generation: 13 lines generated in 0.007s
2025-09-03 08:11:33,433 - root - DEBUG - [common.py:105] - Successfully converted complex structure to PostgreSQL SQL
2025-09-03 08:11:33,433 - root - DEBUG - [common.py:105] - PostgreSQL format conversion completed
2025-09-03 08:11:33,433 - root - DEBUG - [common.py:105] - Writing PostgreSQL format to: files/format_plsql\zzz_postgresql.json
2025-09-03 08:11:33,434 - root - DEBUG - [common.py:105] - Successfully wrote PostgreSQL format to files/format_plsql\zzz_postgresql.json
2025-09-03 08:11:33,434 - root - DEBUG - [common.py:105] - === PL/JSON to PostgreSQL format conversion complete for trigger zzz.json ===
2025-09-03 08:11:33,434 - root - DEBUG - [common.py:105] - âœ“ Created zzz_postgresql.json
2025-09-03 08:11:33,434 - root - INFO - [common.py:110] - === File processing complete ===
2025-09-03 08:11:33,434 - root - INFO - [common.py:110] - Successfully processed: 1 files
2025-09-03 08:11:33,435 - root - INFO - [common.py:110] - === PL/JSON to PostgreSQL format conversion complete ===
2025-09-03 08:11:33,435 - root - INFO - [common.py:110] - âœ“ PostgreSQL format conversion complete! (Duration: 0.15 seconds)
2025-09-03 08:11:33,435 - root - DEBUG - [common.py:105] - Step 6 completed in 0.15 seconds
2025-09-03 08:11:33,435 - root - INFO - [common.py:110] - Step 7: Converting JSON analysis directly to PostgreSQL SQL...
2025-09-03 08:11:33,436 - root - DEBUG - [common.py:105] - Starting Step 7: JSON analysis â†’ PostgreSQL SQL
2025-09-03 08:11:33,436 - root - INFO - [common.py:110] - === Starting JSON analysis to PostgreSQL SQL conversion ===
2025-09-03 08:11:33,436 - root - INFO - [common.py:110] - === Starting file processing ===
2025-09-03 08:11:33,436 - root - INFO - [common.py:110] - Source directory: 'files/format_json'
2025-09-03 08:11:33,437 - root - INFO - [common.py:110] - Target directory: 'files/format_plsql'
2025-09-03 08:11:33,437 - root - INFO - [common.py:110] - File pattern: '_analysis.json'
2025-09-03 08:11:33,437 - root - INFO - [common.py:110] - Output suffix: '_postgresql.sql'
2025-09-03 08:11:33,437 - root - DEBUG - [common.py:105] - Ensuring target directory exists...
2025-09-03 08:11:33,437 - root - DEBUG - [common.py:105] - Directory already exists: files/format_plsql
2025-09-03 08:11:33,438 - root - DEBUG - [common.py:105] - Found 1 files in source directory
2025-09-03 08:11:33,438 - root - DEBUG - [common.py:105] - Files matching pattern '_analysis.json': ['zzz_analysis.json']
2025-09-03 08:11:33,438 - root - DEBUG - [common.py:105] - === Processing file 1/1: zzz_analysis.json ===
2025-09-03 08:11:33,438 - root - DEBUG - [common.py:105] - Source path: files/format_json\zzz_analysis.json
2025-09-03 08:11:33,438 - root - DEBUG - [common.py:105] - Output path: files/format_plsql\zzz_analysis_postgresql.sql
2025-09-03 08:11:33,438 - root - DEBUG - [common.py:105] - === JSON to PostgreSQL SQL processing for trigger zzz_analysis.json ===
2025-09-03 08:11:33,438 - root - DEBUG - [common.py:105] - Reading JSON analysis file: files/format_json\zzz_analysis.json
2025-09-03 08:11:33,439 - root - DEBUG - [main.py:832] - Successfully loaded analysis JSON with keys: ['declarations', 'main', 'sql_comments', 'rest_string_list', 'conversion_stats', 'metadata']
2025-09-03 08:11:33,439 - root - DEBUG - [common.py:105] - Creating FormatSQL instance...
2025-09-03 08:11:33,439 - root - DEBUG - [common.py:105] - Loading function_mappings from Excel file: utilities/oracle_postgresql_mappings.xlsx
2025-09-03 08:11:33,457 - root - DEBUG - [common.py:105] - Loaded 116 function_mappings mappings from Excel
2025-09-03 08:11:33,457 - root - DEBUG - [common.py:105] - Loading data_type_mappings from Excel file: utilities/oracle_postgresql_mappings.xlsx
2025-09-03 08:11:33,471 - root - DEBUG - [common.py:105] - Loaded 42 data_type_mappings mappings from Excel
2025-09-03 08:11:33,471 - utilities.FormatSQL - DEBUG - [FormatSQL.py:116] - FORMATOracleTriggerAnalyzer initialized successfully
2025-09-03 08:11:33,471 - root - DEBUG - [common.py:105] - FormatSQL created successfully
2025-09-03 08:11:33,471 - root - DEBUG - [common.py:105] - Rendering PostgreSQL SQL from analysis...
2025-09-03 08:11:33,472 - utilities.FormatSQL - DEBUG - [FormatSQL.py:274] - SQL generation: Converting JSON analysis to formatted PostgreSQL SQL
2025-09-03 08:11:33,472 - root - DEBUG - [common.py:105] - Analysis contains 4 variables, 0 constants, 7 exceptions
2025-09-03 08:11:33,472 - root - DEBUG - [common.py:105] - Adding header comments with timestamp for PostgreSQL
2025-09-03 08:11:33,472 - root - DEBUG - [common.py:105] - Starting declarations section rendering
2025-09-03 08:11:33,472 - utilities.FormatSQL - DEBUG - [FormatSQL.py:342] - === Rendering PostgreSQL declarations ===
2025-09-03 08:11:33,472 - utilities.FormatSQL - DEBUG - [FormatSQL.py:392] - === PostgreSQL declarations complete ===
2025-09-03 08:11:33,472 - root - DEBUG - [common.py:105] - Generated 0 lines of declarations
2025-09-03 08:11:33,472 - root - DEBUG - [common.py:105] - Declarations rendering took 0.000s
2025-09-03 08:11:33,472 - root - DEBUG - [common.py:105] - Starting main execution block rendering
2025-09-03 08:11:33,472 - utilities.FormatSQL - DEBUG - [FormatSQL.py:411] - === Rendering main block for PostgreSQL ===
2025-09-03 08:11:33,473 - utilities.FormatSQL - DEBUG - [FormatSQL.py:420] - Rendering 4 variables for PostgreSQL
2025-09-03 08:11:33,473 - utilities.FormatSQL - DEBUG - [FormatSQL.py:451] - Processing 1 statements in main block
2025-09-03 08:11:33,473 - utilities.FormatSQL - DEBUG - [FormatSQL.py:452] - begin_end_statements statements: 1
2025-09-03 08:11:33,473 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ' (INSERTING OR UPDATING) ', 'type': 'if_else', 'if_line_no': 19, 'then_line_no': 20, 'if_indent': 4, 'end_if_line_no': 182, 'then_statements': [{'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}, {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}, {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}], 'if_elses': [{'type': 'elif_statement', 'elif_line_no': 175, 'elif_indent': 4, 'condition': '(DELETING)', 'then_line_no': 175, 'then_statements': [{'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}, {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}]}], 'else_statements': []}
2025-09-03 08:11:33,473 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,474 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'with_statement', 'with_line_no': 21, 'with_indent': 21, 'with_values': "C AS ( SELECT TRIM(REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL)) COL FROM DUAL CONNECT BY REGEXP_SUBSTR(:NEW.HOLIDAY_NAME, '[^,]+', 1, LEVEL) IS NOT NULL )", 'with_statements': "SELECT REGEXP_SUBSTR(C.COL, '[^[]+', 1)        HOLIDAY_DESC, REGEXP_SUBSTR(C.COL, '[^[]+[^]]', 1, 2) COUNTRY_CD BULK COLLECT INTO V_HOLIDAY_DESCS, V_COUNTRY_CODES FROM C; SELECT COUNT(COUNTRY_CD), COUNT(COLUMN_VALUE) - COUNT(DISTINCT COLUMN_VALUE) INTO V_CHK_IS_MULTIVALUE , V_CHK_DISTINCT FROM TABLE (V_COUNTRY_CODES) LEFT JOIN COUNTRIES ON COUNTRY_CD = COLUMN_VALUE         ; IF V_CHK_IS_MULTIVALUE >= 1 AND V_CHK_IS_MULTIVALUE != V_HOLIDAY_DESCS.COUNT THEN RAISE ERR_UPD2; END IF", 'with_end_line_no': 52}
2025-09-03 08:11:33,474 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: with_statement
2025-09-03 08:11:33,478 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ' V_CHK_DISTINCT > 0 ', 'type': 'if_else', 'if_line_no': 54, 'then_line_no': 54, 'if_indent': 8, 'end_if_line_no': 56, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,478 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,478 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_UPD3;', 'statement_line_no': 55, 'statement_indent': 12}
2025-09-03 08:11:33,478 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: raise_statement
2025-09-03 08:11:33,479 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ' V_CHK_IS_MULTIVALUE <= 1 ', 'type': 'if_else', 'if_line_no': 58, 'then_line_no': 58, 'if_indent': 8, 'end_if_line_no': 161, 'then_statements': [{'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,479 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,480 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'begin_end', 'begin_line_no': 59, 'begin_indent': 12, 'begin_end_statements': [{'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}], 'exception_handlers': [{'type': 'exception_handler', 'exception_name': 'OTHERS', 'when_line_no': 92, 'when_indent': 16, 'then_line_no': 92, 'exception_statements': [{'condition': ' SQLCODE = -1407 AND INSTR(SQLERRM, \'"CFG_IRTT_HOLIDAYS"."HOLIDAY_DESC"\') > 0 ', 'type': 'if_else', 'if_line_no': 93, 'then_line_no': 93, 'if_indent': 20, 'end_if_line_no': 97, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_INS;', 'statement_line_no': 94, 'statement_indent': 24}], 'if_elses': [], 'else_statements': []}]}], 'exception_line_no': 91, 'end_line_no': 98}
2025-09-03 08:11:33,480 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: begin_end
2025-09-03 08:11:33,480 - utilities.FormatSQL - DEBUG - [FormatSQL.py:411] - === Rendering main block for PostgreSQL ===
2025-09-03 08:11:33,480 - utilities.FormatSQL - DEBUG - [FormatSQL.py:451] - Processing 1 statements in main block
2025-09-03 08:11:33,480 - utilities.FormatSQL - DEBUG - [FormatSQL.py:452] - begin_end_statements statements: 1
2025-09-03 08:11:33,480 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'merge_statement', 'sql_statement': "MERGE INTO CFG.CFG_IRTT_HOLIDAYS A USING ( SELECT HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND FROM ( SELECT :NEW.HOLIDAY_DATE    HOLIDAY_DATE, :NEW.HOLIDAY_NAME    HOLIDAY_DESC, :NEW.GRANTED         GRANTED, :NEW.VALID_FOR_CH    CH, :NEW.VALID_FOR_USA   USA, :NEW.VALID_FOR_UK    UK, :NEW.VALID_FOR_FR    FR, :NEW.VALID_FOR_DE    DE, :NEW.VALID_FOR_JP    JP, :NEW.HOLIDAY_REMARKS HOLIDAY_REMARKS FROM DUAL )  UNPIVOT (VALID_IND FOR COUNTRY_CD IN (CH AS 'CH', USA AS 'US', UK AS 'GB', FR AS 'FR', DE AS 'DE', JP AS 'JP')) ) B ON (A.HOLIDAY_DATE = B.HOLIDAY_DATE AND A.COUNTRY_CD = B.COUNTRY_CD) WHEN MATCHED THEN UPDATE SET A.GRANTED = B.GRANTED, A.VALID_IND = B.VALID_IND, A.HOLIDAY_DESC = B.HOLIDAY_DESC, A.HOLIDAY_REMARKS = B.HOLIDAY_REMARKS WHEN NOT MATCHED THEN INSERT(HOLIDAY_DATE, HOLIDAY_DESC, GRANTED, COUNTRY_CD, HOLIDAY_REMARKS, VALID_IND) VALUES(B.HOLIDAY_DATE, B.HOLIDAY_DESC, B.GRANTED, B.COUNTRY_CD, B.HOLIDAY_REMARKS, B.VALID_IND);", 'statement_line_no': 60, 'statement_indent': 16}
2025-09-03 08:11:33,480 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: merge_statement
2025-09-03 08:11:33,486 - utilities.FormatSQL - DEBUG - [FormatSQL.py:472] - === Main block complete for PostgreSQL ===
2025-09-03 08:11:33,486 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ' (:NEW.GRANTED != :OLD.GRANTED) ', 'type': 'if_else', 'if_line_no': 166, 'then_line_no': 166, 'if_indent': 8, 'end_if_line_no': 174, 'then_statements': [{'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,486 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,486 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'function_calling', 'function_name': 'MDMAPPL.MDM_UTIL_IRTT.REGENERATE_EVENT_DATES_FOR_MONTH', 'parameters': {'parameter_type': 'named', 'positional_params': [], 'named_params': {'P_YEAR': 'EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE)', 'P_MONTH': 'EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE)', 'P_START_EVENT_DATE': ':NEW.HOLIDAY_DATE'}, 'raw_text': 'P_YEAR => EXTRACT(YEAR FROM :NEW.HOLIDAY_DATE), P_MONTH => EXTRACT(MONTH FROM :NEW.HOLIDAY_DATE), P_START_EVENT_DATE => :NEW.HOLIDAY_DATE'}}
2025-09-03 08:11:33,486 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: function_calling
2025-09-03 08:11:33,487 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'condition': ' :OLD.HOLIDAY_DATE IS NULL ', 'type': 'if_else', 'if_line_no': 176, 'then_line_no': 176, 'if_indent': 8, 'end_if_line_no': 178, 'then_statements': [{'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}], 'if_elses': [], 'else_statements': []}
2025-09-03 08:11:33,487 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: if_else
2025-09-03 08:11:33,487 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'raise_statement', 'sql_statement': 'RAISE ERR_DEL;', 'statement_line_no': 177, 'statement_indent': 12}
2025-09-03 08:11:33,487 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: raise_statement
2025-09-03 08:11:33,488 - utilities.FormatSQL - DEBUG - [FormatSQL.py:495] - statement: {'type': 'delete_statement', 'sql_statement': 'DELETE FROM CFG.CFG_IRTT_HOLIDAYS A WHERE A.HOLIDAY_DATE = :OLD.HOLIDAY_DATE;', 'statement_line_no': 179, 'statement_indent': 8}
2025-09-03 08:11:33,488 - utilities.FormatSQL - DEBUG - [FormatSQL.py:503] - Rendering statement type: delete_statement
2025-09-03 08:11:33,488 - utilities.FormatSQL - DEBUG - [FormatSQL.py:472] - === Main block complete for PostgreSQL ===
2025-09-03 08:11:33,489 - root - DEBUG - [common.py:105] - Generated 26 lines in main execution block
2025-09-03 08:11:33,489 - root - DEBUG - [common.py:105] - Main block rendering took 0.016s
2025-09-03 08:11:33,489 - root - DEBUG - [common.py:105] - Adding footer comments
2025-09-03 08:11:33,489 - root - DEBUG - [common.py:105] - Final SQL contains 26 lines, 2345 characters
2025-09-03 08:11:33,489 - root - DEBUG - [common.py:105] - PostgreSQL SQL generation: 26 lines generated in 0.017s
2025-09-03 08:11:33,489 - root - DEBUG - [common.py:105] - PostgreSQL SQL rendering completed successfully
2025-09-03 08:11:33,489 - root - DEBUG - [common.py:105] - Rendered SQL length: 2345 characters
2025-09-03 08:11:33,489 - root - DEBUG - [common.py:105] - Writing formatted PostgreSQL SQL to: files/format_plsql\zzz_analysis_postgresql.sql
2025-09-03 08:11:33,490 - root - DEBUG - [common.py:105] - Successfully wrote formatted PostgreSQL SQL to files/format_plsql\zzz_analysis_postgresql.sql
2025-09-03 08:11:33,490 - root - DEBUG - [common.py:105] - === JSON to PostgreSQL SQL processing complete for trigger zzz_analysis.json ===
2025-09-03 08:11:33,490 - root - DEBUG - [common.py:105] - âœ“ Created zzz_analysis_postgresql.sql
2025-09-03 08:11:33,490 - root - INFO - [common.py:110] - === File processing complete ===
2025-09-03 08:11:33,490 - root - INFO - [common.py:110] - Successfully processed: 1 files
2025-09-03 08:11:33,491 - root - INFO - [common.py:110] - === JSON analysis to PostgreSQL SQL conversion complete ===
2025-09-03 08:11:33,491 - root - INFO - [common.py:110] - âœ“ Direct PostgreSQL SQL conversion complete! (Duration: 0.06 seconds)
2025-09-03 08:11:33,492 - root - DEBUG - [common.py:105] - Step 7 completed in 0.06 seconds
2025-09-03 08:11:33,492 - root - INFO - [common.py:110] - Step 8: Converting PostgreSQL format JSON to final SQL...
2025-09-03 08:11:33,492 - root - DEBUG - [common.py:105] - Starting Step 8: PostgreSQL JSON â†’ SQL output files
2025-09-03 08:11:33,492 - root - INFO - [common.py:110] - === Starting PostgreSQL format to SQL conversion ===
2025-09-03 08:11:33,492 - root - INFO - [common.py:110] - === Starting file processing ===
2025-09-03 08:11:33,492 - root - INFO - [common.py:110] - Source directory: 'files/format_plsql'
2025-09-03 08:11:33,493 - root - INFO - [common.py:110] - Target directory: 'files/format_plsql'
2025-09-03 08:11:33,493 - root - INFO - [common.py:110] - File pattern: '_postgresql.json'
2025-09-03 08:11:33,493 - root - INFO - [common.py:110] - Output suffix: '.sql'
2025-09-03 08:11:33,493 - root - DEBUG - [common.py:105] - Ensuring target directory exists...
2025-09-03 08:11:33,493 - root - DEBUG - [common.py:105] - Directory already exists: files/format_plsql
2025-09-03 08:11:33,493 - root - DEBUG - [common.py:105] - Found 1 files in source directory
2025-09-03 08:11:33,494 - root - DEBUG - [common.py:105] - Files matching pattern '_postgresql.json': ['zzz_postgresql.json']
2025-09-03 08:11:33,494 - root - DEBUG - [common.py:105] - === Processing file 1/1: zzz_postgresql.json ===
2025-09-03 08:11:33,494 - root - DEBUG - [common.py:105] - Source path: files/format_plsql\zzz_postgresql.json
2025-09-03 08:11:33,494 - root - DEBUG - [common.py:105] - Output path: files/format_plsql\zzz_postgresql.sql
2025-09-03 08:11:33,494 - root - DEBUG - [common.py:105] - === Converting PostgreSQL format to SQL for trigger zzz_postgresql.json ===
2025-09-03 08:11:33,494 - root - DEBUG - [common.py:105] - Reading PostgreSQL format file: files/format_plsql\zzz_postgresql.json
2025-09-03 08:11:33,494 - root - DEBUG - [common.py:105] - Successfully loaded PostgreSQL format data with keys: ['on_insert', 'on_update', 'on_delete']
2025-09-03 08:11:33,494 - root - DEBUG - [common.py:105] - Extracting SQL content...
2025-09-03 08:11:33,494 - root - DEBUG - [common.py:105] - SQL content extraction completed
2025-09-03 08:11:33,494 - root - DEBUG - [common.py:105] - Writing SQL to: files/format_plsql\zzz_postgresql.sql
2025-09-03 08:11:33,495 - root - DEBUG - [common.py:105] - Successfully wrote SQL to files/format_plsql\zzz_postgresql.sql
2025-09-03 08:11:33,495 - root - DEBUG - [common.py:105] - === PostgreSQL format to SQL conversion complete for trigger zzz_postgresql.json ===
2025-09-03 08:11:33,495 - root - DEBUG - [common.py:105] - âœ“ Created zzz_postgresql.sql
2025-09-03 08:11:33,495 - root - INFO - [common.py:110] - === File processing complete ===
2025-09-03 08:11:33,495 - root - INFO - [common.py:110] - Successfully processed: 1 files
2025-09-03 08:11:33,495 - root - INFO - [common.py:110] - === PostgreSQL format to SQL conversion complete ===
2025-09-03 08:11:33,495 - root - INFO - [common.py:110] - âœ“ Final SQL generation complete! (Duration: 0.00 seconds)
2025-09-03 08:11:33,496 - root - DEBUG - [common.py:105] - Step 8 completed in 0.00 seconds
2025-09-03 08:11:33,496 - root - INFO - [common.py:110] - === Batch conversion finished successfully ===
2025-09-03 08:11:33,496 - root - INFO - [common.py:110] - Total execution time: 1.42 seconds
2025-09-03 08:11:33,496 - root - INFO - [common.py:110] - Performance breakdown by step:
2025-09-03 08:11:33,497 - root - INFO - [common.py:110] -   - Step 1 (SQL â†’ JSON):              1.08 seconds (75.8%)
2025-09-03 08:11:33,497 - root - INFO - [common.py:110] -   - Step 2 (JSON â†’ Oracle SQL):       0.06 seconds (4.0%)
2025-09-03 08:11:33,497 - root - INFO - [common.py:110] -   - Step 5 (JSON â†’ PL/JSON):          0.07 seconds (4.8%)
2025-09-03 08:11:33,497 - root - INFO - [common.py:110] -   - Step 6 (PL/JSON â†’ PostgreSQL):    0.15 seconds (10.4%)
2025-09-03 08:11:33,497 - root - INFO - [common.py:110] -   - Step 7 (JSON â†’ PostgreSQL SQL):   0.06 seconds (3.9%)
2025-09-03 08:11:33,498 - root - INFO - [common.py:110] -   - Step 8 (PostgreSQL JSON â†’ SQL):   0.00 seconds (0.3%)
2025-09-03 08:11:33,498 - root - DEBUG - [common.py:105] - Main conversion workflow completed successfully
