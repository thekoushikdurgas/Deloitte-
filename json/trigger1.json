{
    "on_insert": [
        {
            "type": "sql",
            "sql": "DO $$ DECLARE v_counter integer; v_code varchar(2) ; v_odg_no varchar(2) ; v_resgrp_cd varchar(2) ; v_reslin_cd varchar(2) ; v_status_cd varchar(1) ; v_dba_cd integer; v_portf_proj_cd varchar(1) ; v_description varchar(500) ; v_reslin_desc varchar(60) ; v_theme_desc_length integer; v_d_registrat_date date; v_d_ins_date date; v_future_registrat date; v_valid_to date; v_userid varchar(30) ; v_is_admin_cnt integer := 0; v_sec_mol_cnt integer := 0; v_molecule_id varchar(5) := null; v_molecule_rg_no varchar(20) := null; v_molec_in_lic_prtnr varchar(15) := null; v_new_rg_no VARCHAR(20) ; v_comparator_ind VARCHAR(1) ; v_theme_desc_proposal VARCHAR(500) ; v_short_name varchar(30) ; c_molecule_type_id constant INTEGER := 99; c_pharmacological_type_id constant INTEGER := 19; v_evolved_nmp_cnt integer; v_trademark_no NUMERIC; v_molecule_type_id INTEGER; v_pharmacological_type_id INTEGER; v_count_t_mappings integer; v_count_t_mol_map integer; v_seq_no_duplicate_cnt integer; v_manual_short_desc VARCHAR(30) ; invalid_mapping_exists BOOLEAN := FALSE; v_trigger_name varchar(100) := 'COMPANY_ADDRESSES_IOF'; cntr integer; v_country_cd VARCHAR(10) ; v_company_type_cd VARCHAR(10) ; v_valid_from DATE; i1 RECORD; BEGIN if(:new_in_prep_ind = 'N' and v_is_admin_cnt = 0) then RAISE EXCEPTION 'MDM_V_THEMES_IOF: Admin access required for this operation'; If(:new_proposal_id is not null and :old_proposal_id is null) then SELECT COUNT(*) INTO v_evolved_nmp_cnt FROM mdmappl.mdm_v_new_medicine_proposals_mtn WHERE proposal_id = :new_proposal_id AND proposal_status_cd = 'E'; if(v_evolved_nmp_cnt = 0) then update mdmappl.mdm_v_new_medicine_proposals_mtn set proposal_status_cd = 'E', evolved_theme_no = :new_theme_no, proposal_name = v_short_name, reason_for_change = '** Automatic update of proposal_name after short_name change in evolved theme **' where proposal_id = :new_proposal_id; END $$;"
        }
    ],
    "on_update": [
        {
            "type": "sql",
            "sql": "DO $$ DECLARE v_counter integer; v_code varchar(2) ; v_odg_no varchar(2) ; v_resgrp_cd varchar(2) ; v_reslin_cd varchar(2) ; v_status_cd varchar(1) ; v_dba_cd integer; v_portf_proj_cd varchar(1) ; v_description varchar(500) ; v_reslin_desc varchar(60) ; v_theme_desc_length integer; v_d_registrat_date date; v_d_ins_date date; v_future_registrat date; v_valid_to date; v_userid varchar(30) ; v_is_admin_cnt integer := 0; v_sec_mol_cnt integer := 0; v_molecule_id varchar(5) := null; v_molecule_rg_no varchar(20) := null; v_molec_in_lic_prtnr varchar(15) := null; v_new_rg_no VARCHAR(20) ; v_comparator_ind VARCHAR(1) ; v_theme_desc_proposal VARCHAR(500) ; v_short_name varchar(30) ; c_molecule_type_id constant INTEGER := 99; c_pharmacological_type_id constant INTEGER := 19; v_evolved_nmp_cnt integer; v_trademark_no NUMERIC; v_molecule_type_id INTEGER; v_pharmacological_type_id INTEGER; v_count_t_mappings integer; v_count_t_mol_map integer; v_seq_no_duplicate_cnt integer; v_manual_short_desc VARCHAR(30) ; invalid_mapping_exists BOOLEAN := FALSE; v_trigger_name varchar(100) := 'COMPANY_ADDRESSES_IOF'; cntr integer; v_country_cd VARCHAR(10) ; v_company_type_cd VARCHAR(10) ; v_valid_from DATE; i1 RECORD; BEGIN if(:old_in_prep_ind = 'N' or(:old_in_prep_ind = 'Y' and:new_in_prep_ind = 'N') ) and v_is_admin_cnt = 0 then RAISE EXCEPTION 'MDM_V_THEMES_IOF: Admin access required for this operation'; If(:new_proposal_id is not null and :old_proposal_id is null) then SELECT COUNT(*) INTO v_evolved_nmp_cnt FROM mdmappl.mdm_v_new_medicine_proposals_mtn WHERE proposal_id = :new_proposal_id AND proposal_status_cd = 'E'; if(v_evolved_nmp_cnt = 0) then update mdmappl.mdm_v_new_medicine_proposals_mtn set proposal_status_cd = 'E', evolved_theme_no = :new_theme_no, proposal_name = v_short_name, reason_for_change = '** Automatic update of proposal_name after short_name change in evolved theme **' where proposal_id = :new_proposal_id; END $$;"
        }
    ],
    "on_delete": [
        {
            "type": "sql",
            "sql": "DO $$ DECLARE v_counter integer; v_code varchar(2) ; v_odg_no varchar(2) ; v_resgrp_cd varchar(2) ; v_reslin_cd varchar(2) ; v_status_cd varchar(1) ; v_dba_cd integer; v_portf_proj_cd varchar(1) ; v_description varchar(500) ; v_reslin_desc varchar(60) ; v_theme_desc_length integer; v_d_registrat_date date; v_d_ins_date date; v_future_registrat date; v_valid_to date; v_userid varchar(30) ; v_is_admin_cnt integer := 0; v_sec_mol_cnt integer := 0; v_molecule_id varchar(5) := null; v_molecule_rg_no varchar(20) := null; v_molec_in_lic_prtnr varchar(15) := null; v_new_rg_no VARCHAR(20) ; v_comparator_ind VARCHAR(1) ; v_theme_desc_proposal VARCHAR(500) ; v_short_name varchar(30) ; c_molecule_type_id constant INTEGER := 99; c_pharmacological_type_id constant INTEGER := 19; v_evolved_nmp_cnt integer; v_trademark_no NUMERIC; v_molecule_type_id INTEGER; v_pharmacological_type_id INTEGER; v_count_t_mappings integer; v_count_t_mol_map integer; v_seq_no_duplicate_cnt integer; v_manual_short_desc VARCHAR(30) ; invalid_mapping_exists BOOLEAN := FALSE; v_trigger_name varchar(100) := 'COMPANY_ADDRESSES_IOF'; cntr integer; v_country_cd VARCHAR(10) ; v_company_type_cd VARCHAR(10) ; v_valid_from DATE; i1 RECORD; BEGIN if((:old_in_prep_ind = 'N') and v_is_admin_cnt = 0) then RAISE EXCEPTION 'MDM_V_THEMES_IOF: Admin access required for this operation'; END $$;"
        }
    ]
}